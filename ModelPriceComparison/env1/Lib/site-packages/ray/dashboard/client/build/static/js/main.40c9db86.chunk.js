(this["webpackJsonpray-dashboard-client"]=this["webpackJsonpray-dashboard-client"]||[]).push([[1],{10:function(e,t,a){"use strict";a.d(t,"j",(function(){return s})),a.d(t,"m",(function(){return u})),a.d(t,"h",(function(){return m})),a.d(t,"d",(function(){return d})),a.d(t,"a",(function(){return n})),a.d(t,"n",(function(){return p})),a.d(t,"e",(function(){return f})),a.d(t,"f",(function(){return b})),a.d(t,"p",(function(){return g})),a.d(t,"b",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"o",(function(){return E})),a.d(t,"l",(function(){return y})),a.d(t,"k",(function(){return j})),a.d(t,"r",(function(){return O})),a.d(t,"c",(function(){return k})),a.d(t,"g",(function(){return S})),a.d(t,"q",(function(){return N}));var n,r=a(8),o=a.n(r),c=a(16),i=a(43),l=function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n,r,c,l,s,u,m;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.entries(a).map((function(e){return e.join("=")})).join("&"),r=[Object(i.a)(t),n].filter((function(e){return e})).join("?"),e.next=4,fetch(r);case 4:return c=e.sent,e.next=7,c.json();case 7:if(l=e.sent,s=l.result,u=l.msg,m=l.data,s){e.next=11;break}throw Error(u);case 11:return e.abrupt("return",m);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),s=function(){return l("/api/ray_config",{})},u=function(){return l("/usage_stats_enabled",{})},m=function(){return l("/nodes",{view:"details"})},d=function(){return l("logical/actor_groups",{})};function p(e){return e.state!==n.Infeasible&&e.state!==n.PendingResources}!function(e){e.Infeasible="INFEASIBLE",e.PendingResources="PENDING_RESOURCES",e.DependenciesUnready="PENDING",e.PendingCreation="CREATING",e.Alive="ALIVE",e.Restarting="RESTARTING",e.Dead="DEAD"}(n||(n={}));var f=function(e,t){return l("/node_errors",{nodeIp:e,pid:null!==t&&void 0!==t?t:""})},b=function(){var e=Object(c.a)(o.a.mark((function e(t,a){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.b)("/api/v0/logs/file",{params:{node_ip:t,pid:a,lines:15e3}});case 2:return n=e.sent,e.abrupt("return",n.data.substring(1).split("\n"));case 4:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),g=function(e,t,a){return l("/api/launch_profiling",{node_id:e,pid:t,duration:a})},h=function(e){return l("/api/check_profiling_status",{profiling_id:e})},v=function(e){var t=encodeURIComponent(Object(i.a)("/api/get_profiling_info?profiling_id=".concat(e)));return Object(i.a)("/speedscope/index.html#profileURL=".concat(t))},E=function(e,t,a){return l("/logical/kill_actor",{actorId:e,ipAddress:t,port:a})},y=function(){return l("/tune/info",{})},j=function(){return l("/tune/availability",{})},O=function(e){return l("/tune/set_experiment",{experiment:e})},k=function(){return l("/tune/enable_tensorboard",{})},S=function(){var e=Object(c.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l("/memory/memory_table",{groupBy:t}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e){return l("/memory/set_fetch",{shouldFetch:e})}},110:function(e,t,a){"use strict";var n=a(161),r=a(160),o=a(0),c=a.n(o),i=Object(n.a)((function(e){return{card:{padding:e.spacing(2),paddingTop:e.spacing(1.5),margin:[e.spacing(2),e.spacing(1)].map((function(e){return"".concat(e,"px")})).join(" ")},title:{fontSize:e.typography.fontSize+2,fontWeight:500,color:e.palette.text.secondary,marginBottom:e.spacing(1)},body:{padding:e.spacing(.5)}}}));t.a=function(e){var t=e.title,a=e.children,n=i();return c.a.createElement(r.a,{className:n.card},c.a.createElement("div",{className:n.title},t),c.a.createElement("div",{className:n.body},a))}},111:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n,r,o=a(18),c=a(100),i=a(97),l=a(99),s=a(495),u=a(96),m=a(496),d=a(497),p=a(0),f=a.n(p);!function(e){e.ALIVE="ALIVE",e.PENDING="PENDING",e.RECONSTRUCTING="RECONSTRUCTING",e.DEAD="DEAD"}(n||(n={}));var b={node:{ALIVE:c.a,DEAD:i.a},worker:{ALIVE:c.a},actor:(r={},Object(o.a)(r,n.ALIVE,c.a),Object(o.a)(r,n.DEAD,i.a),Object(o.a)(r,n.PENDING,l.a),Object(o.a)(r,n.RECONSTRUCTING,s.a),r),job:{INIT:u.a,SUBMITTED:l.a,DISPATCHED:s.a,RUNNING:c.a,COMPLETED:m.a,FINISHED:m.a,FAILED:i.a}},g={deps:l.a,INFO:m.a,ERROR:i.a},h=function(e){var t=e.type,a=e.status,n=e.suffix,r={padding:"2px 8px",border:"solid 1px",borderRadius:4,fontSize:12,margin:2},o=d.a;return g[t]?o=g[t]:"string"===typeof a&&b[t]&&b[t][a]&&(o=b[t][a]),r.color=o[500],r.borderColor=o[500],o!==d.a&&(r.backgroundColor="".concat(o[500],"20")),f.a.createElement("span",{style:r},a,n)}},113:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l}));var n=a(8),r=a.n(n),o=a(16),c=a(43),i=function(){var e=Object(o.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)("nodes?view=summary");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(r.a.mark((function e(t){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.b)("nodes/".concat(t));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},115:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return s}));var n=a(15),r=a(83),o=a(7),c=a(78),i=a(0),l=function(){var e=Object(i.useState)([]),t=Object(o.a)(e,2),a=t[0],n=t[1];return{changeFilter:function(e,t){var o=a.find((function(t){return t.key===e}));o?o.val=t:a.push({key:e,val:t}),n(Object(r.a)(a))},filterFunc:function(e){return a.every((function(t){return!t.val||Object(c.get)(e,t.key,"").toString().includes(t.val)}))}}},s=function(e){var t=Object(i.useState)({key:e||"",desc:!1}),a=Object(o.a)(t,2),r=a[0],l=a[1];return{sorterFunc:function(e,t){if(!r.key)return 0;var a=e,n=t;return r.desc&&(n=e,a=t),Object(c.get)(n,r.key)?Object(c.get)(a,r.key)?Object(c.get)(n,r.key)>Object(c.get)(a,r.key)?1:-1:1:-1},setSortKey:function(e){return l(Object(n.a)(Object(n.a)({},r),{},{key:e}))},setOrderDesc:function(e){return l(Object(n.a)(Object(n.a)({},r),{},{desc:e}))},sorterKey:r.key}}},117:function(e,t,a){"use strict";var n=a(15),r=a(7),o=a(64),c=a.n(o),i=a(155),l=a.n(i),s=a(0),u=a.n(s),m=a(157),d=(a(423),a(424),a(425),a(81)),p=function(){return Math.random().toString(16).slice(-8)},f=/(?:(?!0000)[0-9]{4}-(?:(?:0[1-9]|1[0-2])-(?:0[1-9]|1[0-9]|2[0-8])|(?:0[13-9]|1[0-2])-(?:29|30)|(?:0[13578]|1[02])-31)|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)-02-29)\s+([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9]/,b=function e(t,a){var n=t.type,r=t.tagName,o=t.properties,c=t.children,i=t.value,l=void 0===i?"":i,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";switch(n){case"element":return u.a.createElement(r,{className:o.className[0],key:"".concat(a,"line").concat(p())},c.map((function(t,n){return e(t,"".concat(a,"-").concat(n),s)})));case"text":if(s&&l.includes(s)){var m=[],d=l.split(s),f=d.shift();if(!f)return u.a.createElement("span",{className:"find-kws"},s);for(;"string"===typeof f;)""!==f?m.push(f):m.push(u.a.createElement("span",{className:"find-kws"},s)),(f=d.shift())&&m.push(u.a.createElement("span",{className:"find-kws"},s));return m}return l;default:return[]}};t.a=function(e){var t=e.content,a=e.width,o=void 0===a?"100%":a,i=e.height,p=e.fontSize,g=void 0===p?12:p,h=e.theme,v=void 0===h?Object(d.c)():h,E=e.keywords,y=void 0===E?"":E,j=e.language,O=void 0===j?"dos":j,k=e.focusLine,S=void 0===k?1:k,N=e.style,x=void 0===N?{}:N,C=e.listRef,w=e.onScrollBottom,I=e.revert,T=void 0!==I&&I,R=e.startTime,F=e.endTime,A=Object(s.useState)([]),D=Object(r.a)(A,2),L=D[0],M=D[1],P=L.length,z=Object(s.useRef)(),U=Object(s.useRef)(null),W=Object(s.useRef)(null);C&&(C.current=W.current);var B=function(e){var t=e.index,a=e.style,r=L[T?L.length-1-t:t],o=r.i,c=r.origin;return u.a.createElement("div",{key:"".concat(t,"list"),style:Object(n.a)(Object(n.a)({},a),{},{overflowX:"visible",whiteSpace:"pre"})},u.a.createElement("span",{style:{marginRight:4,width:6*"".concat(L.length).length+4,color:"#999",display:"inline-block"}},o+1),l.a.highlight(O,c).value.map((function(e){return b(e,t.toString(),y)})))};return Object(s.useEffect)((function(){var e=t.split("\n");z.current&&clearTimeout(z.current),z.current=setTimeout((function(){M(e.map((function(e,t){return{i:t,origin:e,time:((null===e||void 0===e?void 0:e.match(f))||[""])[0]}})).filter((function(e){var t=e.origin.includes(y);return e.time&&R&&!c()(e.time).isAfter(c()(R))&&(t=!1),e.time&&F&&!c()(e.time).isBefore(c()(F))&&(t=!1),t})).map((function(e){return Object(n.a)({},e)})))}),500)}),[t,y,O,R,F]),Object(s.useEffect)((function(){var e;U.current&&(null===(e=U.current)||void 0===e||e.scrollTo((S-1)*(g+6)))}),[S,g]),Object(s.useEffect)((function(){var e=null;if(W.current){var t=function(t){var a=t.target;a&&a.scrollTop+a.clientHeight===a.scrollHeight&&w&&w(t),e=W.current};return W.current.addEventListener("scroll",t),function(){e&&e.removeEventListener("scroll",t)}}}),[w]),u.a.createElement(m.a,{height:i||18*(t.split("\n").length+1),width:o,ref:U,outerRef:W,className:"hljs-".concat(v),style:Object(n.a)({fontSize:g,fontFamily:"menlo, monospace"},x),itemSize:g+6,itemCount:P},B)}},134:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(7),r=a(443),o=a(0),c=a.n(o),i=a(10),l=function(){var e=Object(o.useState)(!1),t=Object(n.a)(e,2),a=t[0],l=t[1],s=Object(o.useState)(!1),u=Object(n.a)(s,2),m=u[0],d=u[1];return Object(o.useEffect)((function(){Object(i.m)().then((function(e){l(e.usageStatsPromptEnabled),d(e.usageStatsEnabled)}))}),[]),a?c.a.createElement(r.a,{style:{marginTop:30},severity:"info"},m?c.a.createElement("span",null,"Usage stats collection is enabled. To disable this, add `--disable-usage-stats` to the command that starts the cluster, or run the following command: `ray disable-usage-stats` before starting the cluster. See"," ",c.a.createElement("a",{href:"https://docs.ray.io/en/master/cluster/usage-stats.html",target:"_blank",rel:"noreferrer"},"https://docs.ray.io/en/master/cluster/usage-stats.html")," ","for more details."):c.a.createElement("span",null,"Usage stats collection is disabled.")):null}},135:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return f}));var n=a(49),r=a(440),o=a(427),c=a(0),i=a.n(c),l=a(86),s=a(22),u=a(21),m=120,d=function(e){if(null===e.gpus)return NaN;var t=e.gpus.filter((function(e){return e.utilizationGpu}));return 0===t.length?NaN:Object(u.b)(t.map((function(e){var t;return null!==(t=e.utilizationGpu)&&void 0!==t?t:0})))/t.length},p=function(e){var t=e.gpu,a=e.slot;return i.a.createElement(r.a,{display:"flex",style:{minWidth:m}},i.a.createElement(o.a,{title:t.name},i.a.createElement(l.a,{variant:"body1"},"[",a,"]:")),void 0!==t.utilizationGpu?i.a.createElement(s.a,{percent:t.utilizationGpu,text:"".concat(t.utilizationGpu.toFixed(1),"%")}):i.a.createElement(n.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},f=function(e){var t=e.resourceSlot,a=t.allocation,r=t.slot,o=a>=1&&void 0===r?"0":void 0===r?"?":r.toString();return i.a.createElement(n.a,{variant:"body1"},"[",o,"]: ",a)},b={id:"gpu",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:d(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:Object(u.a)(t)}(e.nodes);return i.a.createElement("div",{style:{minWidth:m}},isNaN(t)?i.a.createElement(n.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):i.a.createElement(s.a,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node,a=void 0!==t.gpus&&0!==t.gpus.length;return i.a.createElement("div",{style:{minWidth:m}},a?t.gpus.map((function(e,t){return i.a.createElement(p,{gpu:e,slot:t})})):i.a.createElement(n.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"))},WorkerFeatureRenderFn:function(e){var t,a,r=null===(t=e.worker.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,o=null===r||void 0===r?void 0:r.GPU;return a=void 0===o?i.a.createElement(n.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):o.resourceSlots.sort((function(e,t){return void 0===e.slot&&void 0===t.slot?0:void 0===e.slot?1:void 0===t.slot?-1:e.slot-t.slot})).map((function(e){return i.a.createElement(f,{resourceSlot:e})})),i.a.createElement("div",{style:{minWidth:60}},a)},nodeAccessor:function(e){var t=e.node;return d(t)},workerAccessor:function(e){var t;return null!==(t=function(e){var t,a=null===e||void 0===e||null===(t=e.coreWorkerStats[0])||void 0===t?void 0:t.usedResources,n=null===a||void 0===a?void 0:a.GPU;return n&&Object(u.b)(n.resourceSlots.map((function(e){return e.allocation})))}(e.worker))&&void 0!==t?t:0}};t.d=b},139:function(e,t,a){"use strict";t.a=a.p+"static/media/logo.3704c1bb.svg"},167:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(17),c=a.n(o),i=(a(182),a(81));c.a.render(r.a.createElement(i.b,null),document.getElementById("root"))},21:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return o}));var n=a(39),r=function(e){if(0===e.length)return 0;var t,a=0,r=0,o=Object(n.a)(e);try{for(o.s();!(t=o.n()).done;){var c=t.value,i=c.weight;a+=i*c.value,r+=i}}catch(l){o.e(l)}finally{o.f()}return a/r},o=function(e){return e.reduce((function(e,t){return e+t}),0)}},22:function(e,t,a){"use strict";var n=a(7),r=a(161),o=a(444),c=a(49),i=a(0),l=a.n(i),s=Object(r.a)((function(e){return Object(o.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,display:"flex",flexGrow:1},inner:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)}})}));t.a=function(e){var t=e.percent,a=e.text,r=s(),o=Math.max(Math.min(t,100),0),i=[0,255,0],u=i,m=function(e,t,a){var r=Object(n.a)(e,3),o=r[0],c=r[1],i=r[2],l=Object(n.a)(t,3);return[o*(1-a)+l[0]*a,c*(1-a)+l[1]*a,i*(1-a)+l[2]*a]}(i,[255,0,0],o/100),d="\n    linear-gradient(\n      to right,\n      rgba(".concat(u.join(","),", ").concat(.2,") 0%,\n      rgba(").concat(m.join(","),", ").concat(.2,") ").concat(o,"%,\n      transparent ").concat(o,"%\n    )\n  ");return l.a.createElement("span",{className:r.root},l.a.createElement("span",{className:r.inner,style:{background:d,flexGrow:1}},l.a.createElement(c.a,{align:"center"},a)))}},423:function(e,t,a){},424:function(e,t,a){},425:function(e,t,a){},43:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return c}));var n=a(69),r=a.n(n),o=function(e){return e.startsWith("/")?e.slice(1):e},c=function(e,t){return r.a.get(o(e),t)}},81:function(e,t,a){"use strict";a.d(t,"a",(function(){return tr})),a.d(t,"c",(function(){return ar}));var n,r,o,c=a(8),i=a.n(c),l=a(16),s=a(15),u=a(7),m=a(502),d=a(501),p=a(0),f=a.n(p),b=a(19),g=a(67),h=a(61),v=a(161),E=a(444),y=a(49),j=a(488),O=a(503),k=a(494),S=a(10),N=a(134),x=a(23),C=a(24),w=a(26),I=a(25),T=a(4),R=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lastUpdatedAt,n=e.error;return f.a.createElement("div",{className:t.root},null!==a&&f.a.createElement(y.a,{className:t.lastUpdated},"Last updated: ",new Date(a).toLocaleString()),null!==n&&f.a.createElement(y.a,{className:t.error},n))}}]),a}(f.a.Component),F=Object(b.b)((function(e){return{lastUpdatedAt:e.dashboard.lastUpdatedAt,error:e.dashboard.error}}))(Object(T.a)((function(e){return Object(E.a)({root:{marginTop:e.spacing(2)},lastUpdated:{color:e.palette.text.secondary,fontSize:"0.8125rem",textAlign:"center"},error:{color:e.palette.error.main,fontSize:"0.8125rem",textAlign:"center"}})}))(R)),A=a(440),D=a(431),L=a(432),M=a(434),P=a(435),z=a(510),U=a(507),W=a(443),B=function(e,t,a){return t[a]<e[a]?-1:t[a]>e[a]?1:0},_=function(e,t,a){var n=a(e),r=a(t);return r<n?-1:r>n?1:0},G=function(e,t){return function(a,n){return"desc"===e?_(a,n,t):-_(a,n,t)}},H=function(e,t){var a=e.map((function(e,t){return[e,t]}));return a.sort((function(e,a){var n=t(e[0],a[0]);return 0!==n?n:e[1]-a[1]})),a.map((function(e){return e[0]}))},V=a(21),Y=a(107),q=a(160),J=a(478),K=a(145),X=a.n(K),Q=a(146),Z=a.n(Q),$=function(e){var t=e.onClick;return f.a.createElement(X.a,{onClick:t})},ee=function(e){var t=e.onClick;return f.a.createElement(Z.a,{onClick:t})},te=a(427),ae=Object(v.a)({tooltipLabel:{textDecorationLine:"underline",textDecorationColor:"#a6c3e3",textDecorationThickness:"1px",textDecorationStyle:"dotted",cursor:"help"}}),ne=function(e){var t=e.label,a=e.datum,n=e.tooltip,r=ae(),o=f.a.createElement(J.a,{container:!0,item:!0,xs:12},f.a.createElement(J.a,{item:!0,xs:6},f.a.createElement(A.a,{className:n&&r.tooltipLabel},t)),f.a.createElement(J.a,{item:!0,xs:6},f.a.createElement("span",null,a)));return n?f.a.createElement(te.a,{title:n},o):o},re=a(18),oe=a(479),ce=a(22),ie=S.a.Alive,le=S.a.Dead,se=S.a.PendingCreation,ue=S.a.Restarting,me=S.a.DependenciesUnready,de=S.a.Infeasible,pe=S.a.PendingResources,fe=Object(v.a)((function(e){return Object(E.a)({infeasible:{color:e.palette.error.light},pendingResources:{color:e.palette.warning.light},unknown:{color:e.palette.warning.light},creating:{color:e.palette.success.light},alive:{color:e.palette.success.dark},restarting:{color:e.palette.warning.light},dead:{color:"#cccccc"},tooltip:{cursor:"help"}})})),be=(n={},Object(re.a)(n,ie,"The actor is alive and handling remote calls."),Object(re.a)(n,le,"The actor is dead and will not be restarted anymore."),Object(re.a)(n,de,"The actor cannot be created because of insufficient resources in the cluster. Please examine its resource constraints to make sure they are correct or add additional compute to your cluster."),Object(re.a)(n,ue,"The actor died and is restarting."),Object(re.a)(n,se,"The actor's resources and other dependencies are ready, and the Ray backend is processing its creation."),Object(re.a)(n,me,"The actor is pending creation because it is waiting for one or more of its initialization arguments to be ready."),Object(re.a)(n,pe,"The actor is pending resources, such as GPU, Memory, or CPU. It will be created when they become available."),n),ge=function(e){var t,a=e.state,n=e.variant,r=e.showTooltip,o=fe(),c=null!==n&&void 0!==n?n:"body1";switch(a){case de:t=f.a.createElement(y.a,{variant:c,className:o.infeasible},"Infeasible");break;case pe:t=f.a.createElement(y.a,{variant:c,className:o.pendingResources},"Pending Resources");break;case se:t=f.a.createElement(y.a,{variant:c,className:o.creating},"Creating");break;case me:t=f.a.createElement(y.a,{variant:c,className:o.creating},"Dependencies Unready");break;case ie:t=f.a.createElement(y.a,{variant:c,className:o.alive},"Alive");break;case ue:t=f.a.createElement(y.a,{variant:c,className:o.restarting},"Restarting");break;case le:t=f.a.createElement(y.a,{variant:c,className:o.dead},"Dead")}return r?f.a.createElement(te.a,{className:o.tooltip,title:be[a]},t):t},he="https://docs.ray.io/en/master/memory-management.html#debugging-using-ray-memory",ve=Object(v.a)((function(e){return{divider:{width:"100%",margin:"0 auto"},actorTitleWrapper:{marginTop:e.spacing(1),marginBottom:e.spacing(1),fontWeight:"bold",fontSize:"130%"},detailsPane:{margin:e.spacing(1)}}})),Ee=function(e){var t,a,n,r,o=e.actor,c=ve(),i=function(e){var t,a,n,r,o,c,i,l,s,m;return Object(S.n)(e)?[{label:"Resources",value:e.usedResources&&Object.entries(e.usedResources).length>0&&Object.entries(e.usedResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return"".concat(Object(V.b)(n.resourceSlots.map((function(e){return e.allocation})))," ").concat(a)})).join(", ")},{label:"Number of pending tasks",value:null!==(t=null===(a=e.taskQueueLength)||void 0===a?void 0:a.toLocaleString())&&void 0!==t?t:"0",tooltip:"The number of tasks that are currently pending to execute on this actor. If this number remains consistently high, it may indicate that this actor is a bottleneck in your application."},{label:"Number of executed tasks",value:null!==(n=null===(r=e.numExecutedTasks)||void 0===r?void 0:r.toLocaleString())&&void 0!==n?n:"0",tooltip:"The number of tasks this actor has executed throughout its lifetimes."},{label:"Number of ObjectRefs in scope",value:null!==(o=null===(c=e.numObjectRefsInScope)||void 0===c?void 0:c.toLocaleString())&&void 0!==o?o:"0",tooltip:"The number of ObjectRefs that this actor is keeping in scope via its internal state. This does not imply that the objects are in active use or colocated on the node with the actor "+"currently. This can be useful for debugging memory leaks. See the docs at ".concat(he," ")+"for more information."},{label:"Number of local objects",value:null!==(i=null===(l=e.numLocalObjects)||void 0===l?void 0:l.toLocaleString())&&void 0!==i?i:"0",tooltip:"The number of small objects that this actor has stored in its local in-process memory store. This can be useful for "+"debugging memory leaks. See the docs at ".concat(he," for more information")},{label:"Object store memory used (MiB)",value:null!==(s=null===(m=e.usedObjectStoreMemory)||void 0===m?void 0:m.toLocaleString())&&void 0!==s?s:"0",tooltip:"The total amount of memory that this actor is occupying in the Ray object store. If this number is increasing without bounds, you might have a memory leak. See "+"the docs at: ".concat(he," for more information.")}]:[{label:"Actor ID",value:e.actorId,tooltip:""},{label:"Required resources",value:e.requiredResources&&Object.entries(e.requiredResources).length>0&&Object.entries(e.requiredResources).sort((function(e,t){return e[0].localeCompare(t[0])})).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return"".concat(n.toLocaleString()," ").concat(a)})).join(", "),tooltip:""}]}(o);return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:c.actorTitleWrapper},f.a.createElement("div",null,o.actorClass),f.a.createElement(ge,{state:o.state})),Object(S.n)(o)&&f.a.createElement(J.a,{container:!0,spacing:3,className:c.detailsPane},f.a.createElement(J.a,{container:!0,item:!0,xs:6},f.a.createElement(J.a,{item:!0,xs:4},f.a.createElement(y.a,null,"CPU Usage")),f.a.createElement(J.a,{item:!0,xs:4},f.a.createElement(ce.a,{percent:null!==(t=null===(a=o.processStats)||void 0===a?void 0:a.cpuPercent)&&void 0!==t?t:0,text:"".concat(null!==(n=null===(r=o.processStats)||void 0===r?void 0:r.cpuPercent)&&void 0!==n?n:0,"%")})),f.a.createElement(J.a,{item:!0,xs:4})),o.gpus.length>0&&f.a.createElement(J.a,{container:!0,item:!0,xs:6},f.a.createElement(J.a,{item:!0,xs:12},f.a.createElement(y.a,null,"GPU Usage")),o.gpus.map((function(e){var t=e.utilizationGpu?f.a.createElement(ce.a,{percent:100*e.utilizationGpu,text:"".concat(100*e.utilizationGpu,"%")}):f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");return f.a.createElement(f.a.Fragment,{key:e.uuid},f.a.createElement(J.a,{item:!0,xs:4},"[".concat(e.name,"]")),f.a.createElement(J.a,{item:!0,xs:4},t),f.a.createElement(J.a,{item:!0,xs:4}))})))),f.a.createElement(oe.a,{className:c.divider}),f.a.createElement(J.a,{container:!0,className:c.detailsPane},i.map((function(e){var t=e.label,a=e.value,n=e.tooltip;return a&&a.length>0&&f.a.createElement(ne,{key:t,label:t,datum:a,tooltip:n})}))))},ye=Object(v.a)((function(e){return Object(E.a)({root:{borderColor:e.palette.divider,borderStyle:"solid",borderWidth:1,marginTop:e.spacing(2),padding:e.spacing(2),width:"100%"},title:{color:e.palette.text.secondary,fontSize:"0.75rem"},action:{color:e.palette.primary.main,textDecoration:"none","&:hover":{cursor:"pointer"}},infeasible:{color:e.palette.error.main},pendingResources:{color:e.palette.secondary.main},webuiDisplay:{fontSize:"0.875rem"},inlineHTML:{fontSize:"0.875rem",display:"inline"}})})),je=function(e){var t=e.actor,a=Object(p.useState)({}),n=Object(u.a)(a,2),r=n[0],o=n[1],c=ye(),m=function(e){return Object(l.a)(i.a.mark((function a(){var n,c;return i.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(t.state!==S.a.Alive){a.next=8;break}return a.next=3,Object(S.p)(t.nodeId,t.pid,e);case 3:return n=a.sent,o(Object(s.a)(Object(s.a)({},r),{},Object(re.a)({},n,{startTime:Date.now(),latestResponse:null}))),c=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(S.b)(n);case 2:t=e.sent,o(Object(s.a)(Object(s.a)({},r),{},Object(re.a)({},n,Object(s.a)(Object(s.a)({},r[n]),{},{latestResponse:t})))),"pending"===t.status&&setTimeout(c,1e3);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a.next=8,c();case 8:case"end":return a.stop()}}),a)})))},d=[];return Object(S.n)(t)&&t.webuiDisplay&&(d=Object.keys(t.webuiDisplay).sort().map((function(e,a,n){var r=t.webuiDisplay[e],o=JSON.parse(r),i=o.message;return"html"===o.dtype&&(i=f.a.createElement("div",{className:c.inlineHTML,dangerouslySetInnerHTML:{__html:i}})),""===e?f.a.createElement(y.a,{className:c.webuiDisplay},"\xa0 \xa0 ",i):f.a.createElement(y.a,{className:c.webuiDisplay},"\xa0 \xa0 ",e,": ",i)}))),f.a.createElement("div",{className:c.root},f.a.createElement(y.a,{className:c.title},Object(S.n)(t)?f.a.createElement(f.a.Fragment,null,"Actor ",t.actorId," (Profile for",[10,30,60].map((function(e){return f.a.createElement(f.a.Fragment,{key:e}," ",f.a.createElement("span",{className:c.action,onClick:m(e)},e,"s"))})),")"," ",t.state===S.a.Alive&&f.a.createElement("span",{className:c.action,onClick:function(){t.state===S.a.Alive&&Object(S.o)(t.actorId,t.ipAddress,t.port)}},"Kill Actor"),Object.entries(r).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1],r=n.startTime,o=n.latestResponse;return null!==o&&f.a.createElement(f.a.Fragment,{key:a},"(","pending"===o.status?"Profiling for ".concat(Math.round((Date.now()-r)/1e3),"s..."):"finished"===o.status?f.a.createElement("a",{className:c.action,href:Object(S.i)(a),rel:"noopener noreferrer",target:"_blank"},"Profiling result"):"error"===o.status?"Profiling error: ".concat(o.error.trim()):void 0,")"," ")}))):t.state===S.a.Infeasible?f.a.createElement("span",{className:c.infeasible},t.actorClass," cannot be created because the Ray cluster cannot satisfy its resource requirements or its runtime_env could not be created."):f.a.createElement("span",{className:c.pendingResources},t.actorClass," is pending until resources are available.")),f.a.createElement(Ee,{actor:t}),Object(S.n)(t)&&f.a.createElement(f.a.Fragment,null,d.length>0&&f.a.createElement(f.a.Fragment,null,d)))},Oe=function(e){return"".concat(e,"s")},ke=Object(Y.a)(A.a)({textAlign:"center"}),Se=Object(v.a)((function(e){return Object(E.a)({container:{margin:e.spacing(1),padding:e.spacing(1),marginLeft:e.spacing(2)},title:{margin:e.spacing(1)},actorEntry:{width:"100%"}})})),Ne=function(e){var t=e.actorGroup,a=e.title,n=Se(),r=Object(p.useState)(!1),o=Object(u.a)(r,2),c=o[0],i=o[1],l=function(){return i(!c)},s=t.entries.map((function(e,t){var a;return f.a.createElement(A.a,{component:"div",className:n.actorEntry,key:null!==(a=e.actorId)&&void 0!==a?a:t},f.a.createElement(je,{actor:e}))})),m=S.a.Alive,d=S.a.PendingResources,b=S.a.Infeasible,g=t.summary;return f.a.createElement(q.a,{className:n.container},f.a.createElement(A.a,{display:"block",className:n.title},f.a.createElement(y.a,{variant:"h5"},a)),f.a.createElement(J.a,{container:!0,xs:12,spacing:2},f.a.createElement(J.a,{container:!0,item:!0,xs:5,className:n.title},b in g.stateToCount&&f.a.createElement(ne,{label:f.a.createElement(ge,{state:b,variant:"body1",showTooltip:!0}),datum:g.stateToCount[b]}),f.a.createElement(ne,{label:f.a.createElement(ge,{state:m,variant:"body1",showTooltip:!0}),datum:m in g.stateToCount?g.stateToCount[m]:0}),f.a.createElement(ne,{label:f.a.createElement(ge,{state:d,variant:"body1",showTooltip:!0}),datum:d in g.stateToCount?g.stateToCount[d]:0})),f.a.createElement(J.a,{container:!0,item:!0,xs:5,className:n.title},f.a.createElement(ne,{label:"Mean Lifetime",datum:Oe(g.avgLifetime)}),f.a.createElement(ne,{label:"Max Lifetime",datum:Oe(g.maxLifetime)}),f.a.createElement(ne,{label:"Executed Tasks",datum:g.numExecutedTasks}))),c?f.a.createElement(f.a.Fragment,null,f.a.createElement(A.a,null,s),f.a.createElement(ke,null,f.a.createElement($,{onClick:l}))):f.a.createElement(ke,null,f.a.createElement(ee,{onClick:l})))},xe=function(e){var t=e.actorGroups,a=function(e){var t;return null!==(t=e.summary.stateToCount[S.a.Infeasible])&&void 0!==t?t:0},n=Object(V.b)(Object.values(t).map(a)),r=Object(p.useState)(n>0),o=Object(u.a)(r,2),c=o[0],i=o[1],l=H(Object.entries(t),(function(e,t){var n=Object(u.a)(e,2),r=n[0],o=n[1],c=Object(u.a)(t,2),i=c[0],l=c[1],s=a(o),m=a(l);return s!==m?s>m?-1:1:r>i?1:-1})).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return f.a.createElement(Ne,{actorGroup:n,title:a,key:"acg-".concat(a)})}));return f.a.createElement(f.a.Fragment,null,f.a.createElement(U.a,{open:c},f.a.createElement(W.a,{severity:"warning",onClose:function(){return i(!1)}},"There are one or more actors that cannot currently be created due to insufficient cluster resources. These have been sorted to the top of the list. If you are using autoscaling functionality, you may ignore this message.")),l)},Ce=Object(v.a)((function(e){return Object(E.a)({container:{marginBottom:e.spacing(1)}})})),we=function(e){return e.dashboard.actorGroups},Ie=function(){var e=Object(p.useState)(""),t=Object(u.a)(e,2),a=t[0],n=t[1],r=Object(z.a)(a,500),o=Object(u.a)(r,1)[0],c=Ce(),i=Object(b.d)(we);if(!i)return f.a.createElement(y.a,{color:"textSecondary"},"Loading...");if(0===Object.keys(i).length)return f.a.createElement(y.a,{color:"textSecondary"},"Finished loading, but have found no actors yet.");var l=""===o?Object.entries(i):Object.entries(i).filter((function(e){var t=Object(u.a)(e,2),a=t[0];t[1];return function(e,t){var a=t.toLowerCase();return-1!==e.toLowerCase().search(a)}(a,o)}));return f.a.createElement(A.a,{className:c.container},0===l.length?f.a.createElement(y.a,{color:"textSecondary"},"No actors found."):f.a.createElement(f.a.Fragment,null,f.a.createElement(D.a,null,f.a.createElement(L.a,{htmlFor:"actor-name-filter"},"Actor Search"),f.a.createElement(M.a,{id:"actor-name-filter","aria-describedby":"actor-name-helper-text",value:a,onChange:function(e){return n(e.target.value)}}),f.a.createElement(P.a,{id:"actor-name-helper-text"},"Search for an actor by name")),f.a.createElement(xe,{actorGroups:Object.fromEntries(l)})))},Te=a(485),Re=a(441),Fe=a(487),Ae=a(151),De=a.n(Ae),Le=a(150),Me=a.n(Le),Pe=a(149),ze=a.n(Pe),Ue=a(95),We=Object(Ue.b)({name:"dashboard",initialState:{actorGroups:null,tab:0,rayConfig:null,nodeInfo:null,tuneInfo:null,tuneAvailability:null,lastUpdatedAt:null,error:null,memoryTable:null,shouldObtainMemoryTable:!1},reducers:{setTab:function(e,t){e.tab=t.payload},setRayConfig:function(e,t){e.rayConfig=t.payload},setNodeInfo:function(e,t){e.nodeInfo=t.payload.nodeInfo,e.lastUpdatedAt=Date.now()},setActorGroups:function(e,t){e.actorGroups=t.payload.actorGroups},setTuneInfo:function(e,t){e.tuneInfo=t.payload.result,e.lastUpdatedAt=Date.now()},setTuneAvailability:function(e,t){e.tuneAvailability=t.payload.result,e.lastUpdatedAt=Date.now()},setError:function(e,t){e.error=t.payload},setMemoryTable:function(e,t){e.memoryTable=t.payload.memoryTable},setShouldObtainMemoryTable:function(e,t){e.shouldObtainMemoryTable=t.payload}}}),Be=We.actions,_e=We.reducer,Ge=function(e,t){return"".concat((e/("mebibyte"===t?Math.pow(1024,2):Math.pow(1024,3))).toFixed(1)," ").concat("mebibyte"===t?"MiB":"GiB")},He=function(e,t,a,n){var r=Ge(e,a),o=Ge(t,a),c=100*e/t,i="".concat(r," / ").concat(o);return n?"".concat(i," (").concat(c.toFixed(0),"%)"):i},Ve=function(e){var t=Math.floor(e)%60,a=Math.floor(e/60)%60,n=Math.floor(e/60/60)%24,r=Math.floor(e/60/60/24),o=function(e){return e.toString().padStart(2,"0")};return[r?"".concat(r,"d"):"","".concat(o(n),"h"),"".concat(o(a),"m"),"".concat(o(t),"s")].join(" ")},Ye=function(e){try{return(e.toString().split(".")[1].length||0)<=3?e.toString():Math.abs(e.valueOf())>=1?e.toPrecision(5):e.toExponential()}catch(t){return e.toString()}},qe=Object(v.a)((function(e){return Object(E.a)({expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},container:{padding:e.spacing(1),margin:e.spacing(1)}})})),Je=function(e){var t=e.memoryTableSummary,a=qe(),n=[["Total Local Reference Count","".concat(t.totalLocalRefCount)],["Pinned in Memory Count","".concat(t.totalPinnedInMemory)],["Total Used by Pending Tasks Count","".concat(t.totalUsedByPendingTask)],["Total Captured in Objects Count","".concat(t.totalCapturedInObjects)],["Total Memory Used by Objects","".concat(Ge(t.totalObjectSize,"mebibyte"))],["Total Actor Handle Count","".concat(t.totalActorHandles)]];return f.a.createElement(J.a,{container:!0,className:a.container},n.map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return f.a.createElement(ne,{key:a,label:a,datum:n})})))},Ke=a(483),Xe=a(484),Qe=a(481),Ze=a(482),$e=a(508),et=a(480),tt=Object(Y.a)(et.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center"}})),at=(Object(Y.a)(et.a)((function(e){return{padding:e.theme.spacing(1),textAlign:"center",cursor:"pointer"}})),Object(v.a)((function(e){return Object(E.a)({visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1}})}))),nt=function(e){var t=e.order,a=e.orderBy,n=e.onRequestSort,r=e.headerInfo,o=e.firstColumnEmpty,c=at();return f.a.createElement(Qe.a,null,f.a.createElement(Ze.a,null,o&&f.a.createElement(tt,null),r.map((function(e){return e.sortable?f.a.createElement(tt,{key:e.label,align:e.numeric?"right":"left",sortDirection:a===e.id&&t},f.a.createElement($e.a,{active:a===e.id,direction:a===e.id?t:"asc",onClick:(r=e.id,function(e){n(e,r)})},e.label,a===e.id?f.a.createElement("span",{className:c.visuallyHidden},"desc"===t?"sorted descending":"sorted ascending"):null)):f.a.createElement(tt,{key:e.label,align:e.numeric?"right":"left"},e.label);var r}))))},rt=function(e){var t=e.memoryTableEntry,a=-1===t.objectSize?"?":Ge(t.objectSize,"mebibyte"),n=[t.nodeIpAddress,t.pid,t.type,t.objectRef,a,t.referenceType,t.callSite];return f.a.createElement(Ze.a,{hover:!0},n.map((function(e,t){return f.a.createElement(tt,{key:"".concat(t)},e)})))},ot=Object(v.a)((function(e){return Object(E.a)({container:{margin:e.spacing(1),padding:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center"}})})),ct=[{id:"nodeIpAddress",label:"IP Address",numeric:!1,sortable:!0},{id:"pid",label:"PID",numeric:!1,sortable:!0},{id:"type",label:"Type",numeric:!1,sortable:!0},{id:"objectRef",label:"Object Ref",numeric:!1,sortable:!0},{id:"objectSize",label:"Object Size",numeric:!1,sortable:!0},{id:"referenceType",label:"Reference Type",numeric:!1,sortable:!0},{id:"callSite",label:"Call Site",numeric:!1,sortable:!0}],it=function(e){var t=e.tableEntries,a=ot(),n=f.a.useState("asc"),r=Object(u.a)(n,2),o=r[0],c=r[1],i=f.a.useState(null),l=Object(u.a)(i,2),s=l[0],m=l[1],d=s&&function(e,t){return"desc"===e?function(e,a){return B(e,a,t)}:function(e,a){return-B(e,a,t)}}(o,s),p=(d?H(t,d):t).map((function(e){return f.a.createElement(rt,{memoryTableEntry:e,key:e.objectRef})}));return f.a.createElement(q.a,{className:a.container,elevation:2},f.a.createElement(Ke.a,null,f.a.createElement(nt,{orderBy:s,order:o,onRequestSort:function(e,t){t===s?c("asc"===o?"desc":"asc"):(m(t),c("asc"))},headerInfo:ct,firstColumnEmpty:!1}),f.a.createElement(Xe.a,null,p)))},lt=Object(Y.a)(A.a)({textAlign:"center"}),st=Object(v.a)((function(e){return Object(E.a)({container:{marginTop:e.spacing(2),marginBottom:e.spacing(2),paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(2),paddingRight:e.spacing(2)}})})),ut=function(e){var t=e.groupKey,a=e.groupTitle,n=e.entries,r=e.summary,o=e.initialExpanded,c=e.initialVisibleEntries,i=st(),l=Object(p.useState)(o),s=Object(u.a)(l,2),m=s[0],d=s[1],b=Object(p.useState)(c),g=Object(u.a)(b,2),h=g[0],v=g[1],E=function(){return d(!m)},y=n.slice(0,h);return f.a.createElement(q.a,{key:t,className:i.container},a,f.a.createElement(Je,{initialExpanded:!1,memoryTableSummary:r}),m?f.a.createElement(f.a.Fragment,null,f.a.createElement(it,{tableEntries:y}),f.a.createElement(lt,null,n.length>h&&f.a.createElement(ee,{onClick:function(){return v(h+10)}}),f.a.createElement($,{onClick:E}))):f.a.createElement(lt,null,f.a.createElement(ee,{onClick:E})))},mt=function(e,t){return"node"===t?f.a.createElement(y.a,{variant:"h6"},"Node ".concat(e)):"stack_trace"===t?f.a.createElement(dt,{stackTrace:e}):""===t?f.a.createElement(y.a,{variant:"h6"},"All entries"):f.a.createElement(y.a,{variant:"h6"},"Unknown Group")},dt=function(e){var t=e.stackTrace.split(" | ").map((function(e,t){return f.a.createElement(y.a,{variant:0===t?"h6":"subtitle2",style:{marginLeft:"".concat(t,"em")},key:t},0!==t&&f.a.createElement(ze.a,null),e)}));return f.a.createElement(A.a,null,t)},pt=Object(v.a)((function(e){return Object(E.a)({pauseButton:{margin:e.spacing(1),padding:e.spacing(1),float:"right"},select:{minWidth:"7em"}})})),ft=function(e){return e.dashboard.memoryTable},bt=function(e){return 0===Object.keys(e.group).length},gt=function(e){return Math.abs(((new Date).getTime()-e.getTime())/1e3)>10},ht=function(){var e=Object(b.d)(ft),t=Object(b.c)(),a=new Date,n=Object(p.useState)(!1),r=Object(u.a)(n,2),o=r[0],c=r[1],i=o?f.a.createElement(Me.a,null):f.a.createElement(De.a,null),l=pt(),s=Object(p.useState)("node"),m=Object(u.a)(s,2),d=m[0],g=m[1];Object(p.useEffect)((function(){return Object(S.q)(!0),function(){Object(S.q)(!1)}}),[]);var h=Object(p.useCallback)((function(){}),[d,t]),v=Object(p.useRef)(null);if(Object(p.useEffect)((function(){v.current||o||(h(),v.current=setInterval(h,4e3));return function(){v.current&&(clearInterval(v.current),v.current=null)}}),[o,h,t]),!e||bt(e)&&!gt(a))return f.a.createElement(y.a,{align:"center",color:"textSecondary",variant:"h3"},f.a.createElement(Te.a,null)," Loading");if(bt(e)&&gt(a))return f.a.createElement(y.a,{align:"center",color:"textSecondary",variant:"h3"},"Finished loading, but nothing found.");var E=Object.entries(e.group).sort((function(e,t){return Object(u.a)(e,1)[0]<Object(u.a)(t,1)[0]?-1:1})).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return f.a.createElement(ut,{key:a,groupKey:a,groupTitle:mt(a,d),entries:n.entries,summary:n.summary,initialExpanded:!1,initialVisibleEntries:10})}));return f.a.createElement(A.a,null,f.a.createElement(D.a,null,f.a.createElement(L.a,{shrink:!0,id:"group-by-label"},"Group by"),f.a.createElement(Re.a,{labelId:"group-by-label",value:d,className:l.select,onChange:function(e){return g(e.target.value)},color:"primary",displayEmpty:!0},f.a.createElement(Fe.a,{value:""},f.a.createElement("em",null,"None")),f.a.createElement(Fe.a,{value:"node"},"Node IP Address"),f.a.createElement(Fe.a,{value:"stack_trace"},"Stack Trace"))),f.a.createElement(j.a,{color:"primary",className:l.pauseButton,onClick:function(){v.current&&(clearInterval(v.current),v.current=null),Object(S.q)(!o),c(!o)}},i,o?"Resume Collection":"Pause Collection"),E)},vt=a(490),Et=a(505),yt=a(9),jt=a(489),Ot=a(426),kt=a(152),St=a.n(kt),Nt=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.handleClose,n=e.title;return f.a.createElement(jt.a,{classes:{paper:t.paper},fullWidth:!0,maxWidth:"md",onClose:a,open:!0,scroll:"body"},f.a.createElement(Ot.a,{className:t.closeButton,onClick:a},f.a.createElement(St.a,null)),f.a.createElement(y.a,{className:t.title},n),this.props.children)}}]),a}(f.a.Component),xt=Object(T.a)((function(e){return Object(E.a)({paper:{padding:e.spacing(3)},closeButton:{position:"absolute",right:e.spacing(1.5),top:e.spacing(1.5),zIndex:1},title:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1,fontSize:"1.5rem",lineHeight:1,marginBottom:e.spacing(3),paddingBottom:e.spacing(3)}})}))(Nt),Ct=a(59),wt=a.n(Ct),It=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=e.lines;return f.a.createElement(Ke.a,null,f.a.createElement(Xe.a,null,a.map((function(e,a){return f.a.createElement(Ze.a,{key:a},f.a.createElement(et.a,{className:wt()(t.cell,t.lineNumber),"data-line-number":a+1}),f.a.createElement(et.a,{className:wt()(t.cell,t.line)},e))}))))}}]),a}(f.a.Component),Tt=Object(T.a)((function(e){return Object(E.a)({root:{overflowX:"auto"},cell:{borderWidth:0,fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",padding:0,"&:last-child":{paddingRight:0}},lineNumber:{color:e.palette.text.secondary,paddingRight:e.spacing(2),textAlign:"right",verticalAlign:"top",width:"1%","&::before":{content:"attr(data-line-number)"}},line:{textAlign:"left",whiteSpace:"pre-wrap"}})}))(It),Rt=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,a=t.nodeIp,n=t.pid,e.next=4,Object(S.e)(a,n);case 4:r=e.sent,this.setState({result:r.errors,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.clearErrorDialog,n=e.nodeIp,r=this.state,o=r.result,c=r.error;return f.a.createElement(xt,{handleClose:a,title:"Errors"},null!==c?f.a.createElement(y.a,{color:"error"},c):null===o?f.a.createElement(y.a,{color:"textSecondary"},"Loading..."):Object.entries(o).map((function(e){var a=Object(u.a)(e,2),r=a[0],o=a[1];return f.a.createElement(f.a.Fragment,{key:r},f.a.createElement(y.a,{className:t.header},n," (PID: ",r,")"),o.length>0?o.map((function(e,a){var n=e.message,r=e.timestamp;return f.a.createElement("div",{className:t.error,key:a},f.a.createElement(y.a,{className:t.timestamp},"Error at ",new Date(1e3*r).toLocaleString()),f.a.createElement(Tt,{lines:n.trim().split("\n")}))})):f.a.createElement(y.a,{color:"textSecondary"},"No errors found."))})))}}]),a}(f.a.Component),Ft=Object(T.a)((function(e){return Object(E.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},error:{backgroundColor:Object(yt.c)(e.palette.error.main,.04),borderLeftColor:e.palette.error.main,borderLeftStyle:"solid",borderLeftWidth:2,marginTop:e.spacing(3),padding:e.spacing(2)},timestamp:{color:e.palette.text.secondary,marginBottom:e.spacing(1)}})}))(Rt),At=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={result:null,error:null},e}return Object(C.a)(a,[{key:"componentDidMount",value:function(){var e=Object(l.a)(i.a.mark((function e(){var t,a,n,r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props,a=t.nodeIp,n=t.pid,e.next=4,Object(S.f)(a,n);case 4:r=e.sent,this.setState({result:r,error:null}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),this.setState({result:null,error:e.t0.toString()});case 11:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.clearLogDialog,n=e.nodeIp,r=this.state,o=r.result,c=r.error;return f.a.createElement(xt,{handleClose:a,title:"Logs"},null!==c?f.a.createElement(y.a,{color:"error"},c):null===o?f.a.createElement(y.a,{color:"textSecondary"},"Loading..."):f.a.createElement(f.a.Fragment,null,f.a.createElement(y.a,{className:t.header},n," (PID: ",this.props.pid,")"),o.length>0?f.a.createElement("div",{className:t.log},f.a.createElement(Tt,{lines:o})):f.a.createElement(y.a,{color:"textSecondary"},"No logs found.")))}}]),a}(f.a.Component),Dt=Object(T.a)((function(e){return Object(E.a)({header:{lineHeight:1,marginBottom:e.spacing(3),marginTop:e.spacing(3)},log:{backgroundColor:Object(yt.c)(e.palette.primary.main,.04),borderLeftColor:e.palette.primary.main,borderLeftStyle:"solid",borderLeftWidth:2,padding:e.spacing(2)}})}))(At),Lt={id:"cpu",ClusterFeatureRenderFn:function(e){var t=e.nodes,a=Object(V.a)(t.map((function(e){return{weight:e.cpus[0],value:e.cpu}})));return f.a.createElement("div",{style:{minWidth:60}},f.a.createElement(ce.a,{percent:a,text:"".concat(a.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement("div",{style:{minWidth:60}},f.a.createElement(ce.a,{percent:t.cpu,text:"".concat(t.cpu.toFixed(1),"%")}))},WorkerFeatureRenderFn:function(e){var t=e.worker;return f.a.createElement("div",{style:{minWidth:60}},f.a.createElement(ce.a,{percent:t.cpuPercent,text:"".concat(t.cpuPercent.toFixed(1),"%")}))},nodeAccessor:function(e){return e.node.cpu},workerAccessor:function(e){return e.worker.cpuPercent}},Mt=a(39),Pt={id:"disk",ClusterFeatureRenderFn:function(e){var t,a=e.nodes,n=0,r=0,o=Object(Mt.a)(a);try{for(o.s();!(t=o.n()).done;){var c=t.value;"/"in c.disk&&(n+=c.disk["/"].used,r+=c.disk["/"].total)}}catch(i){o.e(i)}finally{o.f()}return f.a.createElement(ce.a,{percent:100*n/r,text:He(n,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(ce.a,{percent:100*t.disk["/"].used/t.disk["/"].total,text:He(t.disk["/"].used,t.disk["/"].total,"gibibyte",!0)})},WorkerFeatureRenderFn:function(){return f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.disk["/"].used}},zt=a(118),Ut=["classes"],Wt=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){return Object(x.a)(this,a),t.apply(this,arguments)}return Object(C.a)(a,[{key:"render",value:function(){var e=this.props,t=e.classes,a=Object(zt.a)(e,Ut);return f.a.createElement("span",Object.assign({className:t.button},a))}}]),a}(f.a.Component),Bt=Object(T.a)((function(e){return Object(E.a)({button:{color:e.palette.primary.main,"&:hover":{cursor:"pointer",textDecoration:"underline"}}})}))(Wt),_t=function(e){var t=e.nodes,a=Object(V.b)(t.map((function(e){var t;return null!==(t=e.errorCount)&&void 0!==t?t:0})));return 0===a?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):f.a.createElement(f.a.Fragment,null,a.toLocaleString()," ",1===a?"error":"errors")},Gt=function(e){return function(t){var a,n=t.node,r=null!==(a=n.errorCount)&&void 0!==a?a:0;return 0===r?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors"):f.a.createElement(Bt,{onClick:function(){return e(n.ip,null)}},"View all errors (",r.toLocaleString(),")")}},Ht=function(e){var t;return null!==(t=e.node.errorCount)&&void 0!==t?t:0},Vt=function(e){return function(t){var a,n=t.node,r=t.worker;return 0!==r.errorCount?f.a.createElement(Bt,{onClick:function(){return e(n.ip,r.pid)}},"View errors (",null===(a=r.errorCount)||void 0===a?void 0:a.toLocaleString(),")"):f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No errors")}},Yt=function(e){var t;return null!==(t=e.worker.errorCount)&&void 0!==t?t:0},qt=function(e){return{id:"errors",ClusterFeatureRenderFn:_t,WorkerFeatureRenderFn:Vt(e),NodeFeatureRenderFn:Gt(e),nodeAccessor:Ht,workerAccessor:Yt}},Jt=a(135),Kt=a(86),Xt=function(e){var t=function(e){return e.memoryUsed&&e.memoryTotal?e.memoryUsed/e.memoryTotal:NaN},a=e.gpus.map(t).filter((function(e){return!!e}));return 0===a.length?NaN:100*(Object(V.b)(e.gpus.map((function(e){return t(e)})))/e.gpus.length)},Qt=function(e){var t=e.gpuName,a=e.slot,n=function(e,t){return"".concat(e," MiB / ").concat(t," MiB")}(e.utilization,e.total);return f.a.createElement(A.a,{display:"flex",style:{minWidth:120}},f.a.createElement(te.a,{title:t},f.a.createElement(Kt.a,{variant:"body1"},"[",a,"]: ",n)))},Zt={id:"gram",ClusterFeatureRenderFn:function(e){var t=function(e){var t=e.map((function(e){return{weight:e.gpus.length,value:Xt(e)}})).filter((function(e){return!isNaN(e.value)}));return 0===t.length?NaN:Object(V.a)(t)}(e.nodes);return f.a.createElement("div",{style:{minWidth:60}},isNaN(t)?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):f.a.createElement(ce.a,{percent:t,text:"".concat(t.toFixed(1),"%")}))},NodeFeatureRenderFn:function(e){var t=e.node.gpus.map((function(e,t){var a={gpuName:e.name,utilization:e.memoryUsed,total:e.memoryTotal,slot:t};return f.a.createElement(Qt,a)}));return f.a.createElement("div",{style:{minWidth:60}},0===t.length?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):f.a.createElement("div",{style:{minWidth:120}},t))},WorkerFeatureRenderFn:function(e){var t=e.worker,a=e.node.gpus.map((function(e,a){var n=e.processes.find((function(e){return e.pid===t.pid}));if(n){var r={gpuName:e.name,total:e.memoryTotal,utilization:n.gpuMemoryUsage,slot:a};return f.a.createElement(Qt,r)}})).filter((function(e){return void 0!==e}));return 0===a.length?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A"):f.a.createElement("div",{style:{minWidth:120}},a)},nodeAccessor:function(e){var t=e.node,a=Xt(t);return isNaN(a)?-1:a},workerAccessor:function(e){var t=e.worker,a=e.node;return 0===a.gpus.length?-1:function(e,t){var a=t.gpus.map((function(e){return e.processes})).map((function(t){return t.find((function(t){return t.pid===e.pid}))})).map((function(e){return(null===e||void 0===e?void 0:e.gpuMemoryUsage)||0}));return Object(V.b)(a)}(t,a)}},$t={id:"host",ClusterFeatureRenderFn:function(e){var t=e.nodes;return f.a.createElement(f.a.Fragment,null,"Totals (",t.length.toLocaleString()," ",1===t.length?"host":"hosts",")")},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(f.a.Fragment,null,t.hostname," (",t.ip,")")},WorkerFeatureRenderFn:function(e){var t=e.worker;return f.a.createElement(f.a.Fragment,null,t.cmdline[0].split("::",2)[0]," (PID: ",t.pid,")")},nodeAccessor:function(e){return e.node.hostname}},ea=function(e){var t=e.nodes,a=Object(V.b)(t.map((function(e){var t;return null!==(t=e.logCount)&&void 0!==t?t:0})));return 0===a?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):f.a.createElement(f.a.Fragment,null,a.toLocaleString()," ",1===a?"line":"lines")},ta=function(e){var t,a=e.node,n=null!==(t=a.logCount)&&void 0!==t?t:0;return 0===n?f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs"):f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},n.toLocaleString()," ",1===a.logCount?"line":"lines")},aa=function(e){var t=e.node;return t.logCount?Object(V.b)(Object.values(t.logCount)):0},na=function(e){return function(t){var a,n=t.worker,r=t.node,o=null!==(a=n.logCount)&&void 0!==a?a:0;return 0!==o?f.a.createElement(Bt,{onClick:function(){return e(r.ip,n.pid)}},"View log (",o.toLocaleString()," ",1===n.logCount?"line":"lines",")"):f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"No logs")}},ra=function(e){var t;return null!==(t=e.worker.logCount)&&void 0!==t?t:0},oa=function(e){return{id:"logs",ClusterFeatureRenderFn:ea,WorkerFeatureRenderFn:na(e),NodeFeatureRenderFn:ta,workerAccessor:ra,nodeAccessor:aa}},ca={id:"objectStoreMemory",ClusterFeatureRenderFn:function(e){var t=e.nodes,a=Object(V.b)(t.map((function(e){return e.raylet.objectStoreAvailableMemory}))),n=Object(V.b)(t.map((function(e){return e.raylet.objectStoreUsedMemory}))),r=n+a;return f.a.createElement("div",{style:{minWidth:60}},f.a.createElement(ce.a,{percent:n/r*100,text:He(n,r,"mebibyte",!1)}))},NodeFeatureRenderFn:function(e){var t=e.node,a=t.raylet.objectStoreAvailableMemory,n=t.raylet.objectStoreUsedMemory,r=a+n;if(void 0===n||void 0===a||0===r)return f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A");var o=n/r;return f.a.createElement("div",{style:{minWidth:60}},f.a.createElement(ce.a,{percent:100*o,text:He(n,r,"mebibyte",!1)}))},WorkerFeatureRenderFn:function(){return f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.raylet.objectStoreUsedMemory},workerAccessor:function(){return 0}},ia={id:"ram",ClusterFeatureRenderFn:function(e){var t,a=e.nodes,n=0,r=0,o=Object(Mt.a)(a);try{for(o.s();!(t=o.n()).done;){var c=t.value;n+=c.mem[0]-c.mem[1],r+=c.mem[0]}}catch(i){o.e(i)}finally{o.f()}return f.a.createElement(ce.a,{percent:100*n/r,text:He(n,r,"gibibyte",!0)})},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(ce.a,{percent:100*(t.mem[0]-t.mem[1])/t.mem[0],text:He(t.mem[0]-t.mem[1],t.mem[0],"gibibyte",!0)})},WorkerFeatureRenderFn:function(e){var t=e.node,a=e.worker;return f.a.createElement(ce.a,{percent:100*a.memoryInfo.rss/t.mem[0],text:Ge(a.memoryInfo.rss,"mebibyte")})},nodeAccessor:function(e){var t=e.node;return 100*(t.mem[0]-t.mem[1])},workerAccessor:function(e){return e.worker.memoryInfo.rss}},la={id:"received",ClusterFeatureRenderFn:function(e){var t,a=e.nodes,n=0,r=Object(Mt.a)(a);try{for(r.s();!(t=r.n()).done;){n+=t.value.networkSpeed[1]}}catch(o){r.e(o)}finally{r.f()}return f.a.createElement(f.a.Fragment,null,Ge(n,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(f.a.Fragment,null,Ge(t.networkSpeed[1],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.networkSpeed[1]}},sa={id:"sent",ClusterFeatureRenderFn:function(e){var t,a=e.nodes,n=0,r=Object(Mt.a)(a);try{for(r.s();!(t=r.n()).done;){n+=t.value.networkSpeed[0]}}catch(o){r.e(o)}finally{r.f()}return f.a.createElement(f.a.Fragment,null,Ge(n,"mebibyte"),"/s")},NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(f.a.Fragment,null,Ge(t.networkSpeed[0],"mebibyte"),"/s")},WorkerFeatureRenderFn:function(){return f.a.createElement(y.a,{color:"textSecondary",component:"span",variant:"inherit"},"N/A")},nodeAccessor:function(e){return e.node.networkSpeed[0]}},ua=function(e){return Date.now()/1e3-e},ma={id:"uptime",NodeFeatureRenderFn:function(e){var t=e.node;return f.a.createElement(f.a.Fragment,null,Ve(ua(t.bootTime)))},WorkerFeatureRenderFn:function(e){var t=e.worker;return f.a.createElement(f.a.Fragment,null,Ve(ua(t.createTime)))},nodeAccessor:function(e){var t=e.node;return ua(t.bootTime)},workerAccessor:function(e){var t=e.worker;return ua(t.createTime)}},da={id:"workers",ClusterFeatureRenderFn:function(e){var t,a=e.nodes,n=0,r=0,o=Object(Mt.a)(a);try{for(o.s();!(t=o.n()).done;){var c=t.value;n+=c.cpus[0],r+=c.workers.length}}catch(i){o.e(i)}finally{o.f()}return f.a.createElement(f.a.Fragment,null,r.toLocaleString()," ",1===r?"worker":"workers"," / ",n.toLocaleString()," ",1===n?"core":"cores")},NodeFeatureRenderFn:function(e){var t=e.node,a=t.cpus[0],n=t.workers.length;return f.a.createElement(f.a.Fragment,null,n.toLocaleString()," ",1===n?"worker":"workers"," / ",a.toLocaleString()," ",1===a?"core":"cores")},WorkerFeatureRenderFn:function(e){var t=e.worker;return f.a.createElement(f.a.Fragment,null,t.cmdline[0].split("::",2)[1])}},pa=a(136),fa=a.n(pa),ba=a(137),ga=a.n(ba),ha=function(e){var t=e.features,a=e.data,n=a.node,r=a.worker;return f.a.createElement(Ze.a,{hover:!0},f.a.createElement(tt,null),t.map((function(e,t){return f.a.createElement(tt,{key:t},f.a.createElement(e,{node:n,worker:r}))})))},va=Object(v.a)((function(e){return Object(E.a)({cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},expandCollapseCell:{cursor:"pointer"},expandCollapseIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"},extraInfo:{fontFamily:"SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace",whiteSpace:"pre"}})})),Ea=function(e){var t=e.features,a=e.node,n=e.initialExpanded,r=e.rayletInfo,o=e.workerFeatureData,c=Object(p.useState)(n),i=Object(u.a)(c,2),l=i[0],s=i[1],m=va(),d=t.map((function(e,t){var n=e.NodeFeatureRenderFn;return f.a.createElement(tt,{className:m.cell,key:t},f.a.createElement(n,{node:a}))}));return f.a.createElement(f.a.Fragment,null,f.a.createElement(Ze.a,{hover:!0},f.a.createElement(et.a,{className:wt()(m.cell,m.expandCollapseCell),onClick:function(){return s(!l)}},l?f.a.createElement(ga.a,{className:m.expandCollapseIcon}):f.a.createElement(fa.a,{className:m.expandCollapseIcon})),d),l&&f.a.createElement(f.a.Fragment,null,void 0!==r&&f.a.createElement(Ze.a,{hover:!0},f.a.createElement(et.a,{className:m.cell}),f.a.createElement(et.a,{className:wt()(m.cell,m.extraInfo),colSpan:t.length},r)),o.map((function(e,a){return f.a.createElement(ha,{key:a,features:t.map((function(e){return e.WorkerFeatureRenderFn})),data:e})}))))},ya=a(153),ja=a.n(ya),Oa=Object(v.a)((function(e){return Object(E.a)({cell:{borderTopColor:e.palette.divider,borderTopStyle:"solid",borderTopWidth:2,padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}},totalIcon:{color:e.palette.text.secondary,fontSize:"1.5em",verticalAlign:"middle"}})})),ka=function(e){var t=e.nodes,a=e.features,n=Oa();return f.a.createElement(Ze.a,{hover:!0},f.a.createElement(et.a,{className:n.cell},f.a.createElement(ja.a,{className:n.totalIcon})),a.map((function(e,a){return e?f.a.createElement(et.a,{className:n.cell,key:a},f.a.createElement(e,{nodes:t})):f.a.createElement(tt,{key:a})})))},Sa=function(e,t){var a=e.sort((function(e,t){var a=e.worker,n=t.worker;return"ray::IDLE"===n.cmdline[0]?-1:"ray::IDLE"===a.cmdline[0]?1:a.pid<n.pid?-1:1}));return t?H(a,t):a},Na=Object(v.a)((function(e){return Object(E.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})})),xa=function(e){var t,a;return null===(t=e.dashboard)||void 0===t||null===(a=t.nodeInfo)||void 0===a?void 0:a.clients.filter((function(e){return"ALIVE"===e.raylet.state}))},Ca=[{id:"host",label:"Host",numeric:!0,sortable:!0},{id:"workers",label:"PID",numeric:!0,sortable:!1},{id:"uptime",label:"Uptime (s)",numeric:!0,sortable:!0},{id:"cpu",label:"CPU",numeric:!1,sortable:!0},{id:"ram",label:"RAM",numeric:!0,sortable:!0},{id:"gpu",label:"GPU",numeric:!0,sortable:!0},{id:"gram",label:"GRAM",numeric:!0,sortable:!0},{id:"objectStoreMemory",label:"Plasma",numeric:!1,sortable:!0},{id:"disk",label:"Disk",numeric:!0,sortable:!0},{id:"sent",label:"Sent",numeric:!0,sortable:!0},{id:"received",label:"Received",numeric:!1,sortable:!0},{id:"logs",label:"Logs",numeric:!1,sortable:!0},{id:"errors",label:"Errors",numeric:!1,sortable:!0}],wa=function(){var e,t,a=Object(p.useState)(null),n=Object(u.a)(a,2),r=n[0],o=n[1],c=Object(p.useState)(null),i=Object(u.a)(c,2),l=i[0],s=i[1],m=Object(p.useState)(!0),d=Object(u.a)(m,2),g=d[0],h=d[1],v=f.a.useState("asc"),E=Object(u.a)(v,2),j=E[0],O=E[1],k=f.a.useState(null),S=Object(u.a)(k,2),N=S[0],x=S[1],C=Na(),w=Object(b.d)(xa);if(!w)return f.a.createElement(y.a,{color:"textSecondary"},"Loading...");var I=Object(V.b)(w.map((function(e){return e.workers.length}))),T=[$t,da,ma,Lt,ia,Jt.d,Zt,ca,Pt,sa,la,oa((function(e,t){return o({nodeIp:e,pid:t})})),qt((function(e,t){return s({nodeIp:e,pid:t})}))],R=null===(e=T.find((function(e){return e.id===N})))||void 0===e?void 0:e.nodeAccessor,F=R&&G(j,R),A=null===(t=T.find((function(e){return e.id===N})))||void 0===t?void 0:t.workerAccessor,D=A&&G(j,A),L=0!==w.map((function(e){return e.gpus})).filter((function(e){return void 0!==e&&0!==e.length})).length,M=0!==w.filter((function(e){return void 0!==e&&void 0!==e.disk&&e.disk["/"].total>10})).length,P=function(e){return(L||"gpu"!==e.id&&"gram"!==e.id)&&(M||"disk"!==e.id)},z=T.filter(P),U=Ca.filter(P),W=g?function(e,t,a,n){return(a?H(e,a):e).map((function(a){var r=a.workers.map((function(e){return{node:a,worker:e}})),o=Sa(r,t);return f.a.createElement(Ea,{key:a.raylet.nodeId,node:a,workerFeatureData:o,features:n,initialExpanded:e.length<=1})}))}(w,D,F,z):function(e,t,a){var n=a.map((function(e){return e.WorkerFeatureRenderFn})),r=e.flatMap((function(e){return e.workers.map((function(t){return{node:e,worker:t}}))}));return Sa(r,t).map((function(e,t){return f.a.createElement(ha,{features:n,data:e,key:"worker-".concat(t)})}))}(w,D,z);return f.a.createElement(f.a.Fragment,null,f.a.createElement(vt.a,{control:f.a.createElement(Et.a,{checked:g,onChange:function(){return h(!g)},color:"primary"}),label:"Group by host"}),f.a.createElement(Ke.a,{className:C.table},f.a.createElement(nt,{onRequestSort:function(e,t){t===N?O("asc"===j?"desc":"asc"):(x(t),O("asc"))},headerInfo:U,order:j,orderBy:N,firstColumnEmpty:!0}),f.a.createElement(Xe.a,null,W,f.a.createElement(ka,{clusterTotalWorkers:I,nodes:w,features:z.map((function(e){return e.ClusterFeatureRenderFn}))}))),null!==r&&f.a.createElement(Dt,{clearLogDialog:function(){return o(null)},nodeIp:r.nodeIp,pid:r.pid}),null!==l&&f.a.createElement(Ft,{clearErrorDialog:function(){return s(null)},nodeIp:l.nodeIp,pid:l.pid}))},Ia=Object(v.a)((function(e){return Object(E.a)({table:{marginTop:e.spacing(1),width:"auto"},cell:{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3),paddingRight:e.spacing(3),textAlign:"center","&:last-child":{paddingRight:e.spacing(3)}},key:{color:e.palette.text.secondary}})})),Ta=Be.setRayConfig,Ra=Be.setError,Fa=function(e){return e.dashboard.rayConfig},Aa=function(){var e=Ia(),t=Object(b.d)(Fa),a=Object(b.c)(),n=Object(p.useCallback)(Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(S.j)();case 3:t=e.sent,a(Ta(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),a(Ra(e.t0.toString()));case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[a]),r=Object(p.useRef)(null);if(Object(p.useEffect)((function(){null===r.current&&(n(),r.current=setInterval(n,1e4));return function(){clearInterval(r.current)}}),[n]),null===t)return f.a.createElement(y.a,{color:"textSecondary"},"No Ray configuration detected.");var o=[{key:"Autoscaling mode",value:t.autoscalingMode},{key:"Head node type",value:t.headType},{key:"Worker node type",value:t.workerType},{key:"Min worker nodes",value:t.minWorkers},{key:"Initial worker nodes",value:t.initialWorkers},{key:"Max worker nodes",value:t.maxWorkers},{key:"Idle timeout",value:"".concat(t.idleTimeoutMinutes," ").concat(1===t.idleTimeoutMinutes?"minute":"minutes")}];return f.a.createElement("div",null,f.a.createElement(y.a,null,"Ray cluster configuration:"),f.a.createElement(Ke.a,{className:e.table},f.a.createElement(Qe.a,null,f.a.createElement(Ze.a,null,f.a.createElement(et.a,{className:e.cell},"Setting"),f.a.createElement(et.a,{className:e.cell},"Value"))),f.a.createElement(Xe.a,null,o.map((function(t,a){var n=t.key,r=t.value;return f.a.createElement(Ze.a,{key:a},f.a.createElement(et.a,{className:wt()(e.cell,e.key)},n),f.a.createElement(et.a,{className:e.cell},r))})))))},Da=a(493),La=a(491),Ma=Be,Pa=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={currentError:"",open:!1},e.handleOpen=function(t){e.setState({open:!0,currentError:t})},e.handleClose=function(){e.setState({open:!1})},e}return Object(C.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.tuneInfo,r=this.state,o=r.currentError,c=r.open;return null===n||0===Object.keys(n.errors).length?null:f.a.createElement(f.a.Fragment,null,f.a.createElement(Ke.a,{className:a.table},f.a.createElement(Qe.a,null,f.a.createElement(Ze.a,null,f.a.createElement(et.a,{className:a.cell}," Job ID"),f.a.createElement(et.a,{className:a.cell}," Trial ID "),f.a.createElement(et.a,{className:a.cell}," Trial Directory "),f.a.createElement(et.a,{className:a.cell}," Error "))),f.a.createElement(Xe.a,null,null!==n.errors&&Object.keys(n.errors).map((function(t,r){return f.a.createElement(Ze.a,{key:r},f.a.createElement(et.a,{className:a.cell},n.errors[t].jobId),f.a.createElement(et.a,{className:a.cell},n.errors[t].trialId),f.a.createElement(et.a,{className:a.cell},t),f.a.createElement(et.a,{className:a.cell},f.a.createElement(La.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t)}},"Show Error")))})))),c&&f.a.createElement(xt,{handleClose:this.handleClose,title:"Error Log"},c&&f.a.createElement(Tt,{lines:n.errors[o].text.trim().split("\n")})))}}]),a}(f.a.Component),za=Object(b.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),Ma)(Object(T.a)((function(e){return Object(E.a)({table:{marginTop:e.spacing(1)},cell:{padding:e.spacing(1),textAlign:"center","&:last-child":{paddingRight:e.spacing(1)}}})}))(Pa)),Ua=a(433),Wa=a(492),Ba=Be,_a=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={sortedColumn:void 0,ascending:!0,metricParamColumn:"",metricColumns:[],paramColumns:[],errorTrial:"",open:!1},e.onColumnClick=function(t,a){var n=e.state.ascending;n=t!==e.state.sortedColumn||!n,e.setState({sortedColumn:t,ascending:n}),a&&e.setState({metricParamColumn:a})},e.humanize=function(e){return e.split("_").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" ")},e.handleOpen=function(t){"number"===typeof t&&(t=t.toString()),e.setState({open:!0,errorTrial:t})},e.handleClose=function(){e.setState({open:!1})},e.sortedCell=function(t,a,n){var r=e.props,o=r.tuneInfo,c=r.classes,i=e.state,l=i.sortedColumn,s=i.ascending,u=i.metricParamColumn,m="asc";if(t!==l||s||(m="desc"),null!==o){var d=function(){return e.onColumnClick(t)};a&&(d=function(){return e.onColumnClick(t,a)}),n||(n=0);var p=!1,b=t+n.toString();return a?(b=a+n.toString(),p=a===u&&l===t):p=t===l,f.a.createElement(et.a,{className:c.cell,key:b,onClick:d},f.a.createElement($e.a,{active:p,direction:m}),a?e.humanize(a):e.humanize(t))}},e.sortedTrialRecords=function(){var t=e.props.tuneInfo,a=e.state,n=a.sortedColumn,r=a.ascending,o=a.metricParamColumn;if(null===t||0===Object.keys(t.trialRecords).length)return null;var c=Object.values(t.trialRecords);if(!n)return c;var i=function(e){return e[n]};return"metrics"!==n&&"params"!==n||(i=function(e){return e[n][o]}),n&&(r?c.sort((function(e,t){return i(e)>i(t)?1:-1})):r||c.sort((function(e,t){return i(e)<i(t)?1:-1}))),c},e.handleMetricChoiceChange=function(t){return function(a){var n=e.state.metricColumns;a.target.checked?(n.push(t),e.setState({metricColumns:n})):(n=n.filter((function(e){return e!==t})),e.setState({metricColumns:n}))}},e.metricChoices=function(t){var a=e.state.metricColumns;return f.a.createElement(D.a,null,f.a.createElement(Ua.a,{component:"legend"},"Select Metrics "),f.a.createElement(Wa.a,null,t.map((function(t){return f.a.createElement(vt.a,{control:f.a.createElement(Et.a,{checked:a.includes(t),onChange:e.handleMetricChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e.handleParamChoiceChange=function(t){return function(a){var n=e.state.paramColumns;a.target.checked?(n.push(t),e.setState({paramColumns:n})):(n=n.filter((function(e){return e!==t})),e.setState({paramColumns:n}))}},e.paramChoices=function(t){var a=e.props.classes,n=e.state.paramColumns;return f.a.createElement(D.a,{className:a.paramChecklist},f.a.createElement(Ua.a,{component:"legend"},"Select Parameters "),f.a.createElement(Wa.a,null,t.map((function(t){return f.a.createElement(vt.a,{control:f.a.createElement(Et.a,{checked:n.includes(t),onChange:e.handleParamChoiceChange(t),value:t,color:"primary"}),label:t})}))))},e}return Object(C.a)(a,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes,n=t.tuneInfo,r=this.state,o=r.metricColumns,c=r.paramColumns,i=r.open,l=r.errorTrial;if(null===n||0===Object.keys(n.trialRecords).length)return null;var s=Object.keys(n.trialRecords)[0],u=n.trialRecords[s].params,m=Object.keys(u).filter((function(e){return"args"!==e})),d=m,p=m.length>3;p&&(0===c.length&&this.setState({paramColumns:m.slice(0,3)}),d=c);var b=Object.keys(n.trialRecords[s].metrics),g=b,h=b.length>3;h&&(0===o.length&&this.setState({metricColumns:b.slice(0,3)}),g=o);var v=this.sortedTrialRecords();return f.a.createElement("div",{className:a.root},f.a.createElement(J.a,{container:!0,spacing:0},(p||h)&&f.a.createElement(J.a,{item:!0,xs:2,className:a.checkboxRoot},p&&this.paramChoices(m),h&&this.metricChoices(b)),f.a.createElement(J.a,{item:!0,xs:p||h?10:12,className:a.table},f.a.createElement(Ke.a,{stickyHeader:!0},f.a.createElement(Qe.a,null,f.a.createElement(Ze.a,null,this.sortedCell("trialId"),this.sortedCell("jobId"),this.sortedCell("startTime"),d.map((function(t,a){return e.sortedCell("params",t,a)})),this.sortedCell("status"),g.map((function(t,a){return e.sortedCell("metrics",t,a)})),f.a.createElement(et.a,{className:a.cell,key:"error"},"Error"))),f.a.createElement(Xe.a,null,null!==v&&v.map((function(t,n){return f.a.createElement(Ze.a,{key:n},f.a.createElement(et.a,{className:a.cell},t.trialId),f.a.createElement(et.a,{className:a.cell},t.jobId),f.a.createElement(et.a,{className:a.cell},t.startTime),d.map((function(e,n){return f.a.createElement(et.a,{className:a.cell,key:n},"number"===typeof t.params[e]?Ye(Number(t.params[e])):t.params[e])})),f.a.createElement(et.a,{className:a.cell},t.status),t.metrics&&g.map((function(e,n){return f.a.createElement(et.a,{className:a.cell,key:n},"number"===typeof t.metrics[e]?Ye(Number(t.metrics[e])):t.metrics[e])})),f.a.createElement(et.a,{className:a.cell},"No Error"===t.error?"No Error":f.a.createElement(La.a,{component:"button",variant:"body2",onClick:function(){e.handleOpen(t.trialId)}},"Show Error")))})))))),i&&f.a.createElement(xt,{handleClose:this.handleClose,title:"Error Log"},i&&f.a.createElement(Tt,{lines:n.trialRecords[l].error.trim().split("\n")})))}}]),a}(f.a.Component),Ga=Object(b.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo}}),Ba)(Object(T.a)((function(e){return Object(E.a)({root:{padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(2)}},table:{marginTop:e.spacing(1),height:"700px",overflowY:"auto"},cell:{padding:e.spacing(1),textAlign:"right","&:last-child":{paddingRight:e.spacing(1)}},checkboxRoot:{height:"500px",overflowY:"auto",overflowX:"auto"},paramChecklist:{marginBottom:e.spacing(2)}})}))(_a)),Ha=Be,Va=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={tensorBoardEnabled:!1,loading:!1},e.handleSubmit=function(){e.setState({loading:!0}),Object(S.c)().then((function(){e.setState({loading:!1})}))},e.tensorBoard=function(){var t=e.props,a=t.classes,n=t.error,r=t.tuneInfo;return f.a.createElement("div",null,"TypeError: Failed to fetch"===n&&f.a.createElement(y.a,{className:a.warning,color:"textSecondary"},'Warning: Tensorboard server closed. View Tensorboard by running "tensorboard --logdir" if not displaying below.'),r&&!r.tensorboard.tensorboardCurrent&&f.a.createElement(y.a,{className:a.warning,color:"textSecondary"},"The below Tensorboard reflects a previously entered log directory. Restart the Ray Dashboard to change the Tensorboard logdir."),f.a.createElement("iframe",{src:"http://localhost:6006/",className:a.board,title:"TensorBoard"}))},e}return Object(C.a)(a,[{key:"enableTensorBoard",value:function(){Object(S.c)(),this.setState({tensorBoardEnabled:!0})}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.tuneInfo,n=this.state.loading;if(null!==a){var r=a.tensorboard.tensorboardEnabled;return f.a.createElement("div",{className:t.root},!r&&f.a.createElement("div",null,f.a.createElement(j.a,{variant:"outlined",onClick:this.handleSubmit,className:t.warning},"Enable TensorBoard"),n&&f.a.createElement(Te.a,{className:t.progress,size:25})),r&&this.tensorBoard())}}}]),a}(f.a.Component),Ya=Object(b.b)((function(e){return{error:e.dashboard.error,tuneInfo:e.dashboard.tuneInfo}}),Ha)(Object(T.a)((function(e){return Object(E.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)}},board:{width:"100%",height:"1000px",border:"none"},warning:{fontSize:"0.8125rem"},progress:{marginLeft:"10px",marginTop:"2px"}})}))(Va)),qa=Be,Ja=function(e){Object(w.a)(a,e);var t=Object(I.a)(a);function a(){var e;Object(x.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).timeout=0,e.state={tabIndex:0,experiment:"",loading:!1},e.refreshTuneInfo=Object(l.a)(i.a.mark((function t(){var a;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.props.tuneAvailability||!e.props.tuneAvailability.available){t.next=6;break}return t.next=4,Object(S.l)();case 4:a=t.sent,e.props.setTuneInfo(a);case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),e.props.setError(t.t0.toString());case 11:return t.prev=11,e.timeout=window.setTimeout(e.refreshTuneInfo,1e3),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[0,8,11,14]])}))),e.handleTabChange=function(t,a){e.setState({tabIndex:a})},e.handleExperimentChange=function(t){e.setState({experiment:t.target.value})},e.handleExperimentSubmit=Object(l.a)(i.a.mark((function t(){return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),t.prev=1,t.next=4,Object(S.r)(e.state.experiment);case 4:return window.clearTimeout(e.timeout),t.next=7,e.refreshTuneInfo();case 7:e.setState({loading:!1}),t.next=14;break;case 10:t.prev=10,t.t0=t.catch(1),e.props.setError(t.t0.toString()),e.setState({loading:!1});case 14:case"end":return t.stop()}}),t,null,[[1,10]])}))),e.experimentChoice=function(t){var a=e.props.classes,n=e.state.loading;return f.a.createElement("div",null,t&&f.a.createElement(y.a,{className:a.heading,color:"textPrimary"},"You can use this tab to monitor Tune jobs, their statuses, hyperparameters, and more. For more information, read the documentation"," ",f.a.createElement("a",{href:"https://docs.ray.io/en/master/ray-dashboard.html#tune"},"here"),"."),f.a.createElement("div",null,f.a.createElement(y.a,{className:a.prompt,color:"textSecondary"},"Enter Tune Log Directory Here:"),f.a.createElement(Da.a,{className:a.input,id:"standard-basic",value:e.state.experiment,onChange:e.handleExperimentChange}),f.a.createElement(j.a,{className:a.submit,variant:"outlined",onClick:e.handleExperimentSubmit},"Submit"),n&&f.a.createElement(Te.a,{className:a.progress,size:25})))},e}return Object(C.a)(a,[{key:"componentWillUnmount",value:function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.clearTimeout(this.timeout);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.tuneInfo,n=e.tuneAvailability;if(n&&!n.trialsAvailable)return this.experimentChoice(!0);var r=this.state.tabIndex,o=[{label:"Table",component:Ga},{label:"TensorBoard",component:Ya}];null!==a&&Object.keys(a.errors).length>0&&o.push({label:"Errors",component:za});var c=o[r].component;return f.a.createElement("div",{className:t.root},this.experimentChoice(!1),f.a.createElement(O.a,{className:t.tabs,indicatorColor:"primary",onChange:this.handleTabChange,textColor:"primary",value:r},o.map((function(e){var t=e.label;return f.a.createElement(k.a,{key:t,label:t})}))),f.a.createElement(c,null))}}]),a}(f.a.Component),Ka=Object(b.b)((function(e){return{tuneInfo:e.dashboard.tuneInfo,tuneAvailability:e.dashboard.tuneAvailability}}),qa)(Object(T.a)((function(e){return Object(E.a)({root:{backgroundColor:e.palette.background.paper},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1},heading:{fontsize:"0.9em",marginTop:e.spacing(2)},warning:{fontSize:"1em"},warningIcon:{fontSize:"1.25em",verticalAlign:"text-bottom"},formControl:{margin:e.spacing(1),minWidth:120},submit:{marginLeft:e.spacing(2),fontSize:"0.8125em"},prompt:{fontSize:"1em",marginTop:e.spacing(1)},input:{width:"85%"},progress:{marginLeft:e.spacing(2)}})}))(Ja)),Xa=Be.setNodeInfo,Qa=Be.setTuneAvailability,Za=Be.setActorGroups,$a=Be.setError,en=Be.setTab,tn=Object(v.a)((function(e){return Object(E.a)({root:{backgroundColor:e.palette.background.paper,padding:e.spacing(2),"& > :not(:first-child)":{marginTop:e.spacing(4)},position:"relative"},tabs:{borderBottomColor:e.palette.divider,borderBottomStyle:"solid",borderBottomWidth:1}})})),an=function(e){return e.dashboard.tab},nn=function(e){return e.dashboard.tuneAvailability},rn=[{label:"Machine view",component:wa},{label:"Logical view",component:Ie},{label:"Memory",component:ht},{label:"Ray config",component:Aa},{label:"Tune",component:Ka}],on=function(){var e=Object(b.c)(),t=Object(b.d)(nn),a=Object(b.d)(an),n=tn(),r=Object(h.g)(),o=Object(p.useCallback)(Object(l.a)(i.a.mark((function t(){var a,n,r,o,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all([Object(S.h)(),Object(S.k)(),Object(S.d)()]);case 3:a=t.sent,n=Object(u.a)(a,3),r=n[0],o=n[1],c=n[2],e(Xa({nodeInfo:r})),e(Qa(o)),e(Za(c)),e($a(null)),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),e($a(t.t0.toString()));case 17:case"end":return t.stop()}}),t,null,[[0,14]])}))),[e]),c=Object(p.useRef)(null);Object(p.useEffect)((function(){null===c.current&&(o(),c.current=setInterval(o,1e3));return function(){clearInterval(c.current)}}),[o]);var s=rn.slice();null!==t&&t.available||s.splice(4);var m=s[a].component;return f.a.createElement("div",{className:n.root},f.a.createElement(y.a,{variant:"h5"},"Ray Dashboard"),f.a.createElement(j.a,{style:{position:"absolute",right:16,top:16},variant:"contained",size:"small",color:"primary",onClick:function(){return r.push("/node")}},"Back to new dashboard"),f.a.createElement(O.a,{className:n.tabs,indicatorColor:"primary",onChange:function(t,a){return e(en(a))},textColor:"primary",value:a},s.map((function(e){var t=e.label;return f.a.createElement(k.a,{key:t,label:t})}))),f.a.createElement(m,null),f.a.createElement(N.a,null),f.a.createElement(F,null))},cn=a(83),ln=a(498),sn=a(499),un=a(509),mn=a(500),dn=a(506),pn=a(504),fn=a(64),bn=a.n(fn),gn=a(69),hn=a.n(gn),vn=function(e){if(e)return hn.a.get("events?job_id=".concat(e))},En=a(115),yn=a(117),jn=a(111),On=Object(v.a)((function(e){return{table:{marginTop:e.spacing(4),padding:e.spacing(2)},pageMeta:{padding:e.spacing(2),marginTop:e.spacing(2)},search:{margin:e.spacing(1),display:"inline-block",fontSize:12,lineHeight:"46px"},infokv:{margin:e.spacing(1)},li:{color:e.palette.text.secondary,fontSize:12},code:{wordBreak:"break-all",whiteSpace:"pre-line",margin:12,fontSize:14,color:e.palette.text.primary}}})),kn=function(e){var t=On(),a=function(e){var t=e.job_id,a=Object(p.useContext)(tr).nodeMap,n=Object(p.useState)(!0),r=Object(u.a)(n,2),o=r[0],c=r[1],m=Object(En.a)(),d=m.changeFilter,f=m.filterFunc,b=Object(p.useState)([]),g=Object(u.a)(b,2),h=g[0],v=g[1],E=Object(p.useState)([]),y=Object(u.a)(E,2),j=y[0],O=y[1],k=Object(p.useState)({pageNo:1,pageSize:10,total:0}),S=Object(u.a)(k,2),N=S[0],x=S[1],C=h.filter(f).length,w=N.pageSize;Object(p.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){var a,n,r,o,l,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=8;break}return e.next=4,vn(t);case 4:(null===(r=e.sent)||void 0===r||null===(a=r.data)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.events)&&v(r.data.data.events.sort((function(e,t){return Number(t.timestamp)-Number(e.timestamp)}))),e.next=12;break;case 8:return e.next=10,hn.a.get("events");case 10:(null===(s=e.sent)||void 0===s||null===(o=s.data)||void 0===o||null===(l=o.data)||void 0===l?void 0:l.events)&&(O(Object.keys(s.data.data.events).filter((function(e){return""!==e}))),v(Object.values(s.data.data.events).reduce((function(e,t){return e.concat(t)})).sort((function(e,t){return Number(t.timestamp)-Number(e.timestamp)}))));case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(0);case 16:return e.prev=16,c(!1),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[0,14,16,19]])})));return function(){return e.apply(this,arguments)}}();e()}),[t]),Object(p.useEffect)((function(){x((function(e){return Object(s.a)(Object(s.a)({},e),{},{total:Math.ceil(C/e.pageSize),pageNo:1})}))}),[C,w]);var I=[(N.pageNo-1)*N.pageSize,N.pageNo*N.pageSize];return{events:h.filter(f).slice(I[0],I[1]),changeFilter:function(){d.apply(void 0,arguments),x(Object(s.a)(Object(s.a)({},N),{},{pageNo:1}))},isJob:!!t,jobOptions:j,pagination:N,changePage:function(e,t){x(Object(s.a)(Object(s.a)({},N),{},Object(re.a)({},e,t)))},labelOptions:Array.from(new Set(h.map((function(e){return e.label})))),hostOptions:Array.from(new Set(h.map((function(e){return e.sourceHostname||e.hostName})))),sourceOptions:Array.from(new Set(h.map((function(e){return e.sourceType})))),severityOptions:Array.from(new Set(h.map((function(e){return e.severity})))),loading:o,reverseEvents:function(){v(Object(cn.a)(h.reverse()))},nodeMap:a}}(e),n=a.events,r=a.changeFilter,o=a.isJob,c=a.jobOptions,m=a.pagination,d=a.changePage,b=a.labelOptions,h=a.hostOptions,v=a.sourceOptions,E=a.severityOptions,y=a.loading,O=a.reverseEvents,k=a.nodeMap;return y?f.a.createElement(ln.a,null):f.a.createElement("div",{style:{position:"relative"}},f.a.createElement("div",null,f.a.createElement(dn.a,{className:t.search,style:{width:200},options:b,onInputChange:function(e,t){r("label",t.trim())},renderInput:function(e){return f.a.createElement(Da.a,Object.assign({},e,{label:"Label"}))}}),f.a.createElement(dn.a,{className:t.search,style:{width:200},options:h,onInputChange:function(e,t){r("sourceHostname",t.trim())},renderInput:function(e){return f.a.createElement(Da.a,Object.assign({},e,{label:"Host"}))}}),f.a.createElement(dn.a,{className:t.search,style:{width:100},options:v,onInputChange:function(e,t){r("sourceType",t.trim())},renderInput:function(e){return f.a.createElement(Da.a,Object.assign({},e,{label:"Source"}))}}),f.a.createElement(dn.a,{className:t.search,style:{width:140},options:E,onInputChange:function(e,t){r("severity",t.trim())},renderInput:function(e){return f.a.createElement(Da.a,Object.assign({},e,{label:"Severity"}))}}),!o&&f.a.createElement(dn.a,{className:t.search,style:{width:100},options:c,onInputChange:function(e,t){r("jobId",t.trim())},renderInput:function(e){return f.a.createElement(Da.a,Object.assign({},e,{label:"Job"}))}}),f.a.createElement(Da.a,{className:t.search,label:"Msg",InputProps:{onChange:function(e){var t=e.target.value;r("message",t.trim())},endAdornment:f.a.createElement(sn.a,{position:"end"},f.a.createElement(mn.a,null))}}),f.a.createElement(Da.a,{className:t.search,label:"Page Size",InputProps:{onChange:function(e){var t=e.target.value;d("pageSize",Math.min(Number(t),500)||10)},value:m.pageSize}}),f.a.createElement(j.a,{className:t.search,onClick:function(){return O()}},"Reverse")),f.a.createElement("div",null,f.a.createElement(pn.a,{count:m.total,page:m.pageNo,onChange:function(e,t){d("pageNo",t)}})),f.a.createElement("div",{className:t.pageMeta},n.length?n.map((function(e){var a=e.label,n=e.message,r=e.timestamp,o=e.timeStamp,c=e.sourceType,i=e.sourceHostname,l=e.hostName,s=e.sourcePid,u=e.pid,m=e.eventId,d=e.jobId,p=e.jobName,b=e.nodeId,h=e.severity,v=e.customFields,E=o||bn()(Math.floor(1e3*r)).format("YYYY-MM-DD HH:mm:ss"),y=i||l,j=u||s;return f.a.createElement("article",{className:t.li,key:m},f.a.createElement(J.a,{container:!0,spacing:4},f.a.createElement(J.a,{item:!0},f.a.createElement(jn.a,{status:a,type:h})),f.a.createElement(J.a,{item:!0},E),v&&f.a.createElement(J.a,{item:!0},f.a.createElement(te.a,{interactive:!0,title:f.a.createElement("pre",{style:{whiteSpace:"pre-wrap"}},JSON.stringify(v,null,2))},f.a.createElement(un.a,{size:"small",label:"CustomFields"})))),f.a.createElement(J.a,{container:!0},f.a.createElement(J.a,{item:!0,className:t.infokv},"severity: ",h),f.a.createElement(J.a,{item:!0,className:t.infokv},"source: ",c),f.a.createElement(J.a,{item:!0,className:t.infokv},"hostname:"," ",k[y]?f.a.createElement(g.b,{to:"/node/".concat(k[y])},y):y),f.a.createElement(J.a,{item:!0,className:t.infokv},"pid: ",j),d&&f.a.createElement(J.a,{item:!0,className:t.infokv},"jobId: ",f.a.createElement(g.b,{to:"/job/".concat(d)},d)),p&&f.a.createElement(J.a,{item:!0,className:t.infokv},"jobId: ",p),m&&f.a.createElement(J.a,{item:!0,className:t.infokv},"eventId: ",m),b&&f.a.createElement(J.a,{item:!0,className:t.infokv},"nodeId: ",b)),f.a.createElement(yn.a,{content:n,language:"prolog"}))})):"No Events Yet."),f.a.createElement("div",null,f.a.createElement(pn.a,{count:m.total,page:m.pageNo,onChange:function(e,t){d("pageNo",t)}})))},Sn=a(110),Nn=Object(v.a)((function(e){return{root:{padding:e.spacing(2)}}})),xn=function(){var e=Nn();return f.a.createElement("div",{className:e.root},f.a.createElement(Sn.a,{title:"Event"},f.a.createElement(kn,null)))},Cn=a(139),wn=function(){return f.a.createElement("div",{style:{height:"100vh",width:"100vw"}},f.a.createElement("div",{style:{margin:"250px auto 0 auto",textAlign:"center",fontSize:40,fontWeight:500}},f.a.createElement("img",{src:Cn.a,alt:"Loading",width:100}),f.a.createElement("br",null),"Loading..."))},In=Object(v.a)((function(e){return Object(E.a)({root:{},grafanaEmbedsContainer:{marginTop:e.spacing(1),marginLeft:e.spacing(1),display:"flex",flexDirection:"row",flexWrap:"wrap"},grafanaEmbed:{margin:e.spacing(1)},topBar:{position:"sticky",width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(1)},timeRangeButton:{marginLeft:e.spacing(2)}})}));!function(e){e.FIVE_MINS="Last 5 minutes",e.THIRTY_MINS="Last 30 minutes",e.ONE_HOUR="Last 1 hour",e.THREE_HOURS="Last 3 hours",e.SIX_HOURS="Last 6 hours",e.TWELVE_HOURS="Last 12 hours",e.ONE_DAY="Last 1 day",e.TWO_DAYS="Last 2 days",e.SEVEN_DAYS="Last 7 days"}(o||(o={}));var Tn=(r={},Object(re.a)(r,o.FIVE_MINS,"now-5m"),Object(re.a)(r,o.THIRTY_MINS,"now-30m"),Object(re.a)(r,o.ONE_HOUR,"now-1h"),Object(re.a)(r,o.THREE_HOURS,"now-3h"),Object(re.a)(r,o.SIX_HOURS,"now-6h"),Object(re.a)(r,o.TWELVE_HOURS,"now-12h"),Object(re.a)(r,o.ONE_DAY,"now-1d"),Object(re.a)(r,o.TWO_DAYS,"now-2d"),Object(re.a)(r,o.SEVEN_DAYS,"now-7d"),r),Rn=[{title:"Scheduler Task State",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=26"},{title:"Scheduler CPUs (logical slots)",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=27"},{title:"Object Store Memory",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=29"},{title:"Scheduler GPUs (logical slots)",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=28"},{title:"Node CPU",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=2"},{title:"Node GPU",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=8"},{title:"Node Disk",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=6"},{title:"Node Memory",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=4"},{title:"Node GPU Memory",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=18"},{title:"Node Network",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=20"},{title:"Instance count",path:"/d-solo/rayDefaultDashboard/default-dashboard?orgId=1&theme=light&panelId=24"}],Fn=function(){var e=In(),t=Object(p.useContext)(tr).grafanaHost,a=Object(p.useState)(o.ONE_HOUR),n=Object(u.a)(a,2),r=n[0],c=n[1],i=Object(p.useState)([null,null]),l=Object(u.a)(i,2),s=Object(u.a)(l[0],2),m=s[0],d=s[1],b=l[1];Object(p.useEffect)((function(){b([Tn[r],"now"])}),[r]);var g=null!==m?"&from=".concat(m):"",h=null!==d?"&to=".concat(d):"",v="".concat(g).concat(h);return f.a.createElement("div",{className:e.root},void 0===t?f.a.createElement(W.a,{style:{marginTop:30},severity:"warning"},"Grafana server not detected. Please make sure the grafana server is running and refresh this page. See:"," ",f.a.createElement("a",{href:"https://docs.ray.io/en/latest/ray-observability/ray-metrics.html",target:"_blank",rel:"noreferrer"},"https://docs.ray.io/en/latest/ray-observability/ray-metrics.html"),".",f.a.createElement("br",null),"If you are hosting grafana on a separate machine or using a non-default port, please set the RAY_GRAFANA_HOST env var to point to your grafana server when launching ray."):f.a.createElement("div",null,f.a.createElement(q.a,{className:e.topBar},f.a.createElement(j.a,{href:t,target:"_blank",rel:"noopener noreferrer"},"View in Grafana"),f.a.createElement(Da.a,{className:e.timeRangeButton,select:!0,size:"small",variant:"outlined",style:{width:120},value:r,onChange:function(e){var t=e.target.value;c(t)}},Object.entries(o).map((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];return f.a.createElement(Fe.a,{key:a,value:n},n)})))),f.a.createElement("div",{className:e.grafanaEmbedsContainer},Rn.map((function(a){var n=a.title,r=a.path;return f.a.createElement("iframe",{key:n,className:e.grafanaEmbed,title:n,src:"".concat(t).concat(r,"&refresh").concat(v),width:"450",height:"400",frameBorder:"0"})})))))},An=a(43),Dn=function(){var e=Object(l.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(An.b)("/api/grafana_health");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ln=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Dn();case 3:if(!(t=e.sent).data.result){e.next=6;break}return e.abrupt("return",t.data.data.grafanaHost);case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:return e.abrupt("return",void 0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),Mn=a(113),Pn=Object(Ue.a)({reducer:{dashboard:_e},devTools:!1}),zn=a(495),Un=a(96),Wn=a(497),Bn=a(156),_n={typography:{fontSize:12,fontFamily:["-apple-system","BlinkMacSystemFont",'"Segoe UI"',"Roboto",'"Helvetica Neue"',"Arial","sans-serif",'"Apple Color Emoji"','"Segoe UI Emoji"','"Segoe UI Symbol"'].join(","),body1:{fontSize:"0.75rem"}},props:{MuiPaper:{elevation:0}}},Gn=Object(Bn.a)(Object(s.a)(Object(s.a)({},_n),{},{palette:{primary:{main:"#538DF9"},secondary:zn.a,success:{main:"#43A047"},error:{main:"#D32F2F"},text:{primary:Un.a[900],secondary:Un.a[800],disabled:Un.a[400],hint:Un.a[300]},background:{paper:"#fff",default:Wn.a[50]}}})),Hn=Object(Bn.a)(Object(s.a)(Object(s.a)({},_n),{},{palette:{primary:{main:"#538DF9"},secondary:zn.a,success:{main:"#43A047"},error:{main:"#D32F2F"},text:{primary:Wn.a[50],secondary:Wn.a[100],disabled:Wn.a[200],hint:Wn.a[300]},background:{paper:Un.a[800],default:Un.a[900]}}})),Vn=f.a.lazy((function(){return Promise.all([a.e(0),a.e(10)]).then(a.bind(null,533))})),Yn=f.a.lazy((function(){return a.e(11).then(a.bind(null,534))})),qn=f.a.lazy((function(){return a.e(6).then(a.bind(null,535))})),Jn=f.a.lazy((function(){return a.e(5).then(a.bind(null,531))})),Kn=f.a.lazy((function(){return Promise.all([a.e(0),a.e(7)]).then(a.bind(null,536))})),Xn=f.a.lazy((function(){return a.e(12).then(a.bind(null,530))})),Qn=f.a.lazy((function(){return a.e(8).then(a.bind(null,537))})),Zn=f.a.lazy((function(){return a.e(4).then(a.bind(null,532))})),$n=f.a.lazy((function(){return Promise.all([a.e(0),a.e(9)]).then(a.bind(null,538))})),er="ray-dashboard-theme",tr=f.a.createContext({nodeMap:{},nodeMapByIp:{},ipLogMap:{},namespaceMap:{},grafanaHost:void 0}),ar=function(){return function(e){var t=window.localStorage.getItem(e);try{return JSON.parse(t||"")}catch(a){return t}}(er)||"light"},nr=function(e){return t=er,a=e,window.localStorage.setItem(t,JSON.stringify(a));var t,a};t.b=function(){var e,t=Object(p.useState)(ar()),a=Object(u.a)(t,2),n=a[0],r=a[1],o=Object(p.useState)({nodeMap:{},nodeMapByIp:{},ipLogMap:{},namespaceMap:{},grafanaHost:void 0}),c=Object(u.a)(o,2),v=c[0],E=c[1],y=function(e){nr(e),r(e)};return Object(p.useEffect)((function(){Object(Mn.b)().then((function(e){var t,a;if(null===e||void 0===e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.summary){var n={},r={},o={};e.data.data.summary.forEach((function(e){var t=e.hostname,a=e.raylet,c=e.ip,i=e.logUrl;n[t]=a.nodeId,r[c]=a.nodeId,o[c]=i})),E((function(e){return Object(s.a)(Object(s.a)({},e),{},{nodeMap:n,nodeMapByIp:r,ipLogMap:o,namespaceMap:{}})}))}}))}),[]),Object(p.useEffect)((function(){var e=function(){var e=Object(l.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ln();case 2:t=e.sent,E((function(e){return Object(s.a)(Object(s.a)({},e),{},{grafanaHost:t})}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),f.a.createElement(d.a,{theme:(e=n,"dark"===e?Hn:Gn)},f.a.createElement(p.Suspense,{fallback:wn},f.a.createElement(tr.Provider,{value:v},f.a.createElement(b.a,{store:Pn},f.a.createElement(m.a,null),f.a.createElement(g.a,null,f.a.createElement(h.d,null,f.a.createElement(h.b,{component:function(){return f.a.createElement(h.a,{to:"/node"})},exact:!0,path:"/"}),f.a.createElement(h.b,{component:on,exact:!0,path:"/legacy"}),f.a.createElement(h.b,{render:function(e){return f.a.createElement(Xn,Object.assign({},e,{setTheme:y,theme:n}),f.a.createElement(h.b,{component:qn,exact:!0,path:"/summary"}),f.a.createElement(h.b,{component:Jn,exact:!0,path:"/job"}),f.a.createElement(h.b,{component:Zn,exact:!0,path:"/node"}),f.a.createElement(h.b,{component:Vn,exact:!0,path:"/actors"}),f.a.createElement(h.b,{component:xn,exact:!0,path:"/events"}),f.a.createElement(h.b,{component:Fn,exact:!0,path:"/metrics"}),f.a.createElement(h.b,{render:function(e){return f.a.createElement(Qn,Object.assign({},e,{theme:n}))},exact:!0,path:"/log/:host?/:path?"}),f.a.createElement(h.b,{component:$n,path:"/node/:id"}),f.a.createElement(h.b,{component:Kn,path:"/job/:id"}),f.a.createElement(h.b,{component:Yn,path:"/cmd/:cmd/:ip/:pid"}),f.a.createElement(h.b,{component:wn,exact:!0,path:"/loading"}))}})))))))}},86:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(107),r=a(49),o=Object(n.a)(r.a)((function(e){return{paddingRight:e.theme.spacing(1)}}))}},[[167,2,3]]]);
//# sourceMappingURL=main.40c9db86.chunk.js.map